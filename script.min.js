let scene,camera,renderer,room,animationId,composer,bloomPass,objLoader,gltfLoader,fbxLoader,mouseX=0,mouseY=0,isMouseDown=!1,targetRotationX=0,targetRotationY=0,rotationX=0,rotationY=0,cameraDistance=5,targetCameraDistance=5,cameraAngleX=0,cameraAngleY=0,targetCameraAngleX=0,targetCameraAngleY=0,loadedAssets={};const SATURATION_BOOST=1.8;function boostColorSaturation(e,t){if(!e||"function"!=typeof e.getHSL)return;const o={h:0,s:0,l:0};e.getHSL(o),o.s=Math.min(1,o.s*t),e.setHSL(o.h,o.s,o.l)}function boostMaterialSaturation(e,t){e&&(Array.isArray(e)?e.forEach(e=>boostMaterialSaturation(e,t)):e.color&&(boostColorSaturation(e.color,t),e.needsUpdate=!0))}function boostSaturationOnGroup(e,t=1.8){e&&e.traverse&&e.traverse(e=>{e.isMesh&&e.material&&boostMaterialSaturation(e.material,t)})}function increaseBrightnessOnGroup(e,t=1.15){e&&e.traverse&&e.traverse(e=>{if(e.isMesh&&e.material){const o=e=>{e&&e.color&&(e.color.multiplyScalar(t),e.needsUpdate=!0)};Array.isArray(e.material)?e.material.forEach(o):o(e.material)}})}function init3D(){const e=document.getElementById("room-canvas");if(!e)return void console.error("Canvas element not found!");if("undefined"==typeof THREE)return void console.error("Three.js not loaded!");console.log("Initializing 3D scene..."),scene=new THREE.Scene,scene.background=new THREE.Color(16777215),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),cameraAngleX=.1,cameraAngleY=.8,targetCameraAngleX=.1,targetCameraAngleY=.8,cameraDistance=12,targetCameraDistance=12,updateCameraPosition(),renderer=new THREE.WebGLRenderer({canvas:e,antialias:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.outputEncoding=THREE.sRGBEncoding,renderer.toneMapping=THREE.ACESFilmicToneMapping,renderer.toneMappingExposure=1,renderer.physicallyCorrectLights=!0,renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,setupBloomEffect();const t=new THREE.AmbientLight(16771276,.4);scene.add(t);const o=new THREE.DirectionalLight(16770764,1);o.position.set(5,5,5),o.castShadow=!0,o.shadow.mapSize.width=2048,o.shadow.mapSize.height=2048,scene.add(o),createBasicRoom(),animate(),addMouseControls(),waitForLoadersAndLoadAssets(),setTimeout(()=>{hideLoadingScreen()},1500)}function hideLoadingScreen(){const e=document.getElementById("loading-screen");e&&setTimeout(()=>{e.classList.add("hidden"),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},500)},2e3)}function updateCameraPosition(){const e=cameraDistance*Math.sin(cameraAngleY)*Math.cos(cameraAngleX),t=cameraDistance*Math.sin(cameraAngleX),o=cameraDistance*Math.cos(cameraAngleY)*Math.cos(cameraAngleX);camera.position.set(e,t,o),camera.lookAt(0,0,0)}function initLoaders(){void 0!==THREE.OBJLoader&&(objLoader=new THREE.OBJLoader),void 0!==THREE.GLTFLoader&&(gltfLoader=new THREE.GLTFLoader),void 0!==THREE.FBXLoader&&(fbxLoader=new THREE.FBXLoader)}function waitForLoadersAndLoadAssets(){const e=()=>{void 0!==THREE.GLTFLoader?(console.log("GLTF Loader is now available, initializing loaders..."),initLoaders(),loadAssets().then(()=>{updateRoomWithNewAssets()})):(console.log("Waiting for GLTF Loader to be available..."),setTimeout(e,100))};e()}let musicPlayer,totalAssets=0,loadedAssetsCount=0;function updateProgress(){const e=document.getElementById("progress-fill"),t=document.getElementById("progress-text");if(e&&t){const o=Math.round(loadedAssetsCount/totalAssets*100);e.style.width=`${o}%`,t.textContent=`${o}%`}}async function loadAssets(){console.log("Loading 3D assets progressively...");const e=[{name:"table",path:"asset_glb/table.glb",type:"gltf",priority:"high"},{name:"laptop",path:"asset_glb/laptop.glb",type:"gltf",priority:"high"},{name:"chair",path:"asset_glb/chairDesk.glb",type:"gltf",priority:"high"}],t=[{name:"table2",path:"asset_glb/table.glb",type:"gltf",priority:"medium"},{name:"lamp",path:"asset_glb/lampRoundTable.glb",type:"gltf",priority:"medium"},{name:"books",path:"asset_glb/books.glb",type:"gltf",priority:"medium"},{name:"newBed",path:"asset_glb/cute_stylized_bed_-_low_poly_-_game_ready.glb",type:"gltf",priority:"medium"}],o=[{name:"cake",path:"asset_glb/strawberry_cake.glb",type:"gltf",priority:"low"},{name:"bunny",path:"asset_glb/bunny_plush_toy.glb",type:"gltf",priority:"low"},{name:"indoorPlantNew",path:"asset_glb/indoor_plant.glb",type:"gltf",priority:"low"},{name:"stringLightsNew",path:"asset_glb/simple_string_lights.glb",type:"gltf",priority:"low"},{name:"windowAsset",path:"asset_glb/window.glb",type:"gltf",priority:"low"}];totalAssets=e.length+t.length+o.length,loadedAssetsCount=0;try{console.log("Loading critical assets..."),await Promise.all(e.map(e=>loadAssetWithProgress(e))),console.log("Critical assets loaded successfully!"),setTimeout(()=>{console.log("Loading secondary assets..."),t.forEach(e=>loadAssetWithProgress(e))},100),setTimeout(()=>{console.log("Loading decorative assets..."),o.forEach(e=>loadAssetWithProgress(e))},500)}catch(e){console.warn("Some critical assets failed to load:",e)}}function loadAssetWithProgress(e){return loadAsset(e).then(()=>{loadedAssetsCount++,updateProgress(),updateRoomWithNewAssets()}).catch(()=>{loadedAssetsCount++,updateProgress()})}function updateRoomWithNewAssets(){console.log("Updating room with newly loaded assets..."),addMissingAssetsToRoom(),updateMirrorRoom()}function updateMirrorRoom(){if(!window.mirroredRoom)return console.warn("Mirrored room not found, recreating..."),void createMirrorReflection();const e=[];room.traverse(t=>{t.name&&""!==t.name&&t!==room&&e.push(t)}),e.forEach(e=>{window.mirroredRoom.getObjectByName(e.name)||addAssetToMirror(e)})}function addMissingAssetsToRoom(){let e=null;loadedAssets.newBed&&!room.getObjectByName("bed")?(e=prepareAsset(loadedAssets.newBed),console.log("Using cute stylized bed")):loadedAssets.bed&&!room.getObjectByName("bed")&&(e=prepareAsset(loadedAssets.bed),console.log("Using regular bed")),e&&(e.name="bed",e.position.set(-1.95,-1.75,-4.5),e.scale.set(3,3,3),e.rotation.y=4.75,room.add(e),increaseBrightnessOnGroup(e,.97),console.log("Added bed to room"));const t=prepareAsset(loadedAssets.table);t&&!room.getObjectByName("desk")&&(t.name="desk",t.position.set(1.5,-2.2,-3.5),t.scale.set(3,6.75,3),t.rotation.y=0,room.add(t),console.log("Added desk to room"));const o=prepareAsset(loadedAssets.laptop);o&&!room.getObjectByName("laptop")&&(o.name="laptop",o.position.set(2,0,-3.8),o.scale.set(4,4,4),o.rotation.y=0,addGlowEffectToBooks(o),room.add(o),console.log("Added laptop to room"));const s=prepareAsset(loadedAssets.chair);s&&!room.getObjectByName("chair")&&(s.name="chair",s.position.set(3.5,-2,-3.5),s.scale.set(4.5,4.5,4.5),s.rotation.y=Math.PI,boostSaturationOnGroup(s,1.05),room.add(s),console.log("Added chair to room"));const a=prepareAsset(loadedAssets.lamp);a&&!room.getObjectByName("lamp")&&(a.name="lamp",a.position.set(3.2,0,-4),a.scale.set(3.75,3.75,3.75),room.add(a),console.log("Added lamp to room"));const n=prepareAsset(loadedAssets.books);n&&!room.getObjectByName("books")&&(n.name="books",n.position.set(2,1.55,-4),n.scale.set(10,10,10),boostSaturationOnGroup(n,1.45),addGlowEffectToBooks(n),room.add(n),console.log("Added books to room"));const i=prepareAsset(loadedAssets.indoorPlantNew);i&&!room.getObjectByName("shelfPlant")&&(i.name="shelfPlant",i.position.set(1.5,1.55,-4.35),i.scale.set(1,1,1),i.rotation.y=-Math.PI/12,boostSaturationOnGroup(i,1.4),room.add(i),console.log("Added shelf plant to room"));const r=prepareAsset(loadedAssets.table2);r&&!room.getObjectByName("table2")&&(r.name="table2",r.position.set(-4.8,-2.2,3.75),r.scale.set(1.75,7,3.5),r.rotation.y=0,room.add(r),console.log("Added second table to room")),createShelves(),addDecorativeAssets()}function addDecorativeAssets(){if(loadedAssets.cake&&!room.getObjectByName("cake")){const e=prepareAsset(loadedAssets.cake);e&&(e.name="cake",e.position.set(-3.9,0,3),e.scale.set(.5,.75,.5),e.rotation.y=Math.PI/4,e.traverse(e=>{e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1)}),addCakeGlowEffect(e),room.add(e),console.log("Added cake to room"))}if(loadedAssets.bunny&&!room.getObjectByName("bunny")){const e=prepareAsset(loadedAssets.bunny);e&&(e.name="bunny",e.position.set(-2.15,.15,-1.5),e.scale.set(2,2,2),e.rotation.y=Math.PI/6,increaseBrightnessOnGroup(e,7),e.traverse&&e.traverse(e=>{if(e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material)){const t=Array.isArray(e.material)?e.material[0]?.map:e.material.map,o=new THREE.MeshLambertMaterial({color:16777215,map:t||null});e.material=o}}),addGlowEffectToBooks(e),room.add(e),console.log("Added bunny to room"))}if(loadedAssets.stringLightsNew&&!room.getObjectByName("stringLights")){const e=prepareAsset(loadedAssets.stringLightsNew);if(e){const t=e.clone();t.name="stringLights",increaseBrightnessOnGroup(t,10),t.position.set(-1.75,3.45,-4.8),t.scale.set(.5,1,2),addGlowEffectToBooks(t),room.add(t),console.log("Added string lights to room")}}if(loadedAssets.windowAsset&&!room.getObjectByName("windowAsset")){const e=prepareAsset(loadedAssets.windowAsset);e&&(e.name="windowAsset",e.position.set(-7.71,-.5,1.5),e.rotation.y=Math.PI,e.scale.set(.05,.05,.05),room.add(e),console.log("Added window asset to room"))}}function loadAsset(e){return new Promise((t,o)=>{let s;if(console.log(`Loading ${e.name}...`),"gltf"===e.type&&gltfLoader)s=gltfLoader;else if("fbx"===e.type&&fbxLoader)s=fbxLoader;else{if("obj"!==e.type||!objLoader)return console.warn(`No suitable loader for ${e.name} (${e.type})`),loadedAssets[e.name]=createGenericPlaceholder(),void t();s=objLoader}s.load(e.path,o=>{"gltf"===e.type?(loadedAssets[e.name]=o.scene,console.log(`Successfully loaded ${e.name} - Type: ${o.scene.type}, Children: ${o.scene.children.length}`)):(loadedAssets[e.name]=o,console.log(`Successfully loaded ${e.name} - Type: ${o.type}, Children: ${o.children?o.children.length:"N/A"}`)),t()},void 0,o=>{console.error(`Error loading ${e.name}:`,o),loadedAssets[e.name]=createGenericPlaceholder(),t()})})}function createGenericPlaceholder(){const e=new THREE.Group,t=new THREE.BoxGeometry(1,1,1),o=new THREE.MeshLambertMaterial({color:8947848}),s=new THREE.Mesh(t,o);return e.add(s),e}function addMouseControls(){const e=document.getElementById("room-canvas");e.addEventListener("mousedown",t=>{isMouseDown=!0,mouseX=t.clientX,mouseY=t.clientY,e.style.cursor="grabbing"}),e.addEventListener("mouseup",()=>{isMouseDown=!1,e.style.cursor="grab"}),e.addEventListener("mousemove",e=>{if(isMouseDown){const t=e.clientX-mouseX,o=e.clientY-mouseY;targetCameraAngleY+=.01*t,targetCameraAngleX+=.01*o,targetCameraAngleX=Math.max(.1,Math.min(Math.PI/2-.1,targetCameraAngleX)),mouseX=e.clientX,mouseY=e.clientY}}),e.addEventListener("mouseleave",()=>{isMouseDown=!1,e.style.cursor="grab"}),e.addEventListener("wheel",e=>{e.preventDefault();targetCameraDistance=e.deltaY<0?Math.max(2,targetCameraDistance-.5):Math.min(15,targetCameraDistance+.5)}),document.addEventListener("keydown",e=>{switch(e.key){case"+":case"=":targetCameraDistance=Math.max(2,targetCameraDistance-.5);break;case"-":targetCameraDistance=Math.min(15,targetCameraDistance+.5);break;case"0":targetCameraDistance=5}}),e.style.cursor="grab"}function createBasicRoom(){console.log("Creating basic 3D room structure..."),room=new THREE.Group,createWalls(),createWindow(),createSunlightBeams(),createMirrorReflection(),scene.add(room),console.log("Basic 3D room created successfully!")}function prepareAsset(e){if(!e||!e.clone)return null;const t=e.clone();return t.traverse&&t.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material&&(Array.isArray(e.material)?e.material.forEach(e=>{e&&(e.needsUpdate=!0)}):e.material.needsUpdate=!0))}),t}function createMirrorReflection(){const e=room.clone();e.scale.y=-1,e.position.y=-5.5,e.traverse(e=>{if(e.userData&&e.userData.isGlowMesh)e.visible=!1;else if(e.isMesh&&e.material)if(Array.isArray(e.material))e.material.forEach(t=>{const o=t.clone();o.transparent=!0,o.opacity=.25,o.depthWrite=!1,o.color&&(o.color.multiplyScalar(.4),o.color.r*=.8,o.color.g*=.9,o.color.b*=1.1),e.material=o});else{const t=e.material.clone();t.transparent=!0,t.opacity=.25,t.depthWrite=!1,t.color&&(t.color.multiplyScalar(.4),t.color.r*=.8,t.color.g*=.9,t.color.b*=1.1),e.material=t}}),scene.add(e),window.mirroredRoom=e,console.log("Room reflection created successfully (glow meshes excluded)!")}function addAssetToMirror(e){if(!window.mirroredRoom)return void console.warn("Mirrored room not found, cannot add asset to mirror");const t=e.clone();t.scale.y=e.scale.y,t.scale.x=e.scale.x,t.scale.z=e.scale.z,t.position.y=-1+e.position.y,t.traverse(e=>{if(e.userData&&e.userData.isGlowMesh)e.visible=!1;else if(e.isMesh&&e.material)if(Array.isArray(e.material))e.material.forEach(t=>{const o=t.clone();o.transparent=!0,o.opacity=.25,o.depthWrite=!1,o.color&&(o.color.multiplyScalar(.4),o.color.r*=.8,o.color.g*=.9,o.color.b*=1.1),e.material=o});else{const t=e.material.clone();t.transparent=!0,t.opacity=.25,t.depthWrite=!1,t.color&&(t.color.multiplyScalar(.4),t.color.r*=.8,t.color.g*=.9,t.color.b*=1.1),e.material=t}}),window.mirroredRoom.add(t),console.log(`Added ${e.name} to mirror at position (${t.position.x}, ${t.position.y}, ${t.position.z})`)}function createShelves(){const e=new THREE.MeshLambertMaterial({color:16777215}),t=new THREE.BoxGeometry(3,.1,1),o=new THREE.Mesh(t,e);o.position.set(2.5,1.5,-4.5),o.castShadow=!0,room.add(o),createPlant(1.5,1.6,-4.5)}function createWoodPlanksTexture({planks:e=6,baseColor:t="#c9916a",variation:o=12,seamColor:s="#7b4f34"}={}){const a=512,n=document.createElement("canvas");n.width=a,n.height=a;const i=n.getContext("2d"),r=(e,t,o)=>Math.max(t,Math.min(o,e));const l=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:201,g:145,b:106}}(t),c=a/e;for(let t=0;t<e;t++){const e=(2*Math.random()-1)*o,n=r(l.r+e,0,255),d=r(l.g+.7*e,0,255),m=r(l.b+.4*e,0,255);i.fillStyle=`rgb(${n},${d},${m})`,i.fillRect(0,t*c,a,c),i.globalAlpha=.08,i.strokeStyle="#000";for(let e=0;e<a;e+=6+10*Math.random()){const o=t*c+Math.random()*c;i.beginPath(),i.moveTo(e,o),i.lineTo(e+30+40*Math.random(),o+6*(Math.random()-.5)),i.stroke()}i.globalAlpha=1,t>0&&(i.fillStyle=s,i.fillRect(0,t*c-2,a,2))}i.fillStyle=s;for(let e=0;e<a;e+=128)i.fillRect(e,0,1,a);const d=new THREE.CanvasTexture(n);return d.wrapS=THREE.RepeatWrapping,d.wrapT=THREE.RepeatWrapping,d.anisotropy=4,d}function createWalls(){const e=new THREE.MeshLambertMaterial({color:12096631}),t=new THREE.MeshLambertMaterial({color:11108197}),o=(new THREE.MeshLambertMaterial({color:16748964}),new THREE.BoxGeometry(10,.5,10)),s=createWoodPlanksTexture({planks:8,baseColor:"#a46d49",variation:18,seamColor:"#6b442c"});s.repeat.set(2,3);const a=new THREE.MeshLambertMaterial({map:s,color:8016182}),n=new THREE.Mesh(o,a);n.position.y=-2.25,n.receiveShadow=!0,n.castShadow=!0,room.add(n);const i=new THREE.BoxGeometry(10.2,.3,10.2),r=new THREE.MeshLambertMaterial({color:2889744}),l=new THREE.Mesh(i,r);l.position.y=-2.6,l.receiveShadow=!0,l.castShadow=!0,room.add(l);const c=new THREE.BoxGeometry(10,8,.3),d=new THREE.Mesh(c,e);d.position.z=-5.15,d.position.y=1.5,d.castShadow=!0,d.receiveShadow=!0,room.add(d);const m=new THREE.BoxGeometry(.3,2.3,10),u=new THREE.Mesh(m,t);u.position.x=-5.15,u.position.y=4.4,u.castShadow=!0,u.receiveShadow=!0,room.add(u);const h=new THREE.BoxGeometry(.3,3,10),p=new THREE.Mesh(h,t);p.position.x=-5.15,p.position.y=-1,p.castShadow=!0,p.receiveShadow=!0,room.add(p);const g=new THREE.BoxGeometry(.3,5,2.9),y=new THREE.Mesh(g,t);y.position.x=-5.15,y.position.y=1.5,y.position.z=-3.55,y.castShadow=!0,y.receiveShadow=!0,room.add(y);const w=new THREE.BoxGeometry(.3,5,6),f=new THREE.Mesh(w,t);f.position.x=-5.15,f.position.y=1.5,f.position.z=2,f.castShadow=!0,f.receiveShadow=!0,room.add(f);const E=new THREE.BoxGeometry(10,.3,.6),b=new THREE.MeshLambertMaterial({color:6636321}),T=new THREE.Mesh(E,b);T.position.z=-5.1,T.position.y=5.65,T.castShadow=!0,T.receiveShadow=!0,room.add(T);const v=new THREE.BoxGeometry(.6,.3,10),M=new THREE.MeshLambertMaterial({color:6636321}),A=new THREE.Mesh(v,M);A.position.x=-5.1,A.position.y=5.65,A.castShadow=!0,A.receiveShadow=!0,room.add(A)}function createPlant(e,t,o,s=3046706){const a=new THREE.Group,n=new THREE.CylinderGeometry(.15,.15,.2,8),i=new THREE.MeshLambertMaterial({color:16761035}),r=new THREE.Mesh(n,i);r.position.set(0,0,0),r.castShadow=!0,a.add(r);const l=new THREE.SphereGeometry(.2,8,6),c=new THREE.MeshLambertMaterial({color:s}),d=new THREE.Mesh(l,c);d.position.set(0,.2,0),d.scale.set(1,1.5,1),d.castShadow=!0,a.add(d);for(let e=0;e<3;e++){const e=new THREE.SphereGeometry(.03,4,4),t=new THREE.MeshLambertMaterial({color:16738740}),o=new THREE.Mesh(e,t);o.position.set(.3*(Math.random()-.5),.3+.1*Math.random(),.3*(Math.random()-.5)),o.castShadow=!0,a.add(o)}a.position.set(e,t,o),room.add(a)}function setupBloomEffect(){}function addGlowEffectToBooks(e){e.userData={glowProcessed:!0,glowMeshes:[]},e.traverse(t=>{if(t.isMesh&&t.material&&!t.userData.glowProcessed&&!t.userData.isGlowMesh){t.userData={glowProcessed:!0};[{scale:1.01,opacity:.04,color:16301017,blending:THREE.AdditiveBlending},{scale:1.03,opacity:.025,color:15771848,blending:THREE.AdditiveBlending},{scale:1.05,opacity:.015,color:15243448,blending:THREE.AdditiveBlending}].forEach((o,s)=>{const a=new THREE.MeshBasicMaterial({color:o.color,transparent:!0,opacity:o.opacity,side:THREE.BackSide,blending:o.blending,depthWrite:!1,depthTest:!1}),n=new THREE.Mesh(t.geometry,a);n.scale.set(o.scale,o.scale,o.scale);const i=.001*(s+1);n.position.set(t.position.x+(Math.random()-.5)*i,t.position.y+(Math.random()-.5)*i,t.position.z+(Math.random()-.5)*i),n.rotation.copy(t.rotation),n.userData={isGlowMesh:!0,layerIndex:s,originalOpacity:o.opacity},t.add(n),e.userData.glowMeshes.push(n)})}}),window.glowingBooks||(window.glowingBooks=[]),window.glowingBooks.push(e)}function addCakeGlowEffect(e){e.userData={glowProcessed:!0,glowMeshes:[]},e.traverse(t=>{if(t.isMesh&&t.material&&!t.userData.glowProcessed&&!t.userData.isGlowMesh){t.userData={glowProcessed:!0};[{scale:1.01,opacity:.02,color:16301017,blending:THREE.AdditiveBlending},{scale:1.02,opacity:.01,color:15771848,blending:THREE.AdditiveBlending}].forEach((o,s)=>{const a=new THREE.MeshBasicMaterial({color:o.color,transparent:!0,opacity:o.opacity,side:THREE.BackSide,blending:o.blending,depthWrite:!1,depthTest:!1}),n=new THREE.Mesh(t.geometry,a);n.scale.set(o.scale,o.scale,o.scale);const i=5e-4*(s+1);n.position.set(t.position.x+(Math.random()-.5)*i,t.position.y+(Math.random()-.5)*i,t.position.z+(Math.random()-.5)*i),n.rotation.copy(t.rotation),n.userData={isGlowMesh:!0,layerIndex:s,originalOpacity:o.opacity},t.add(n),e.userData.glowMeshes.push(n)})}}),window.glowingBooks||(window.glowingBooks=[]),window.glowingBooks.push(e)}function setGlowVisibility(e){window.glowingBooks&&window.glowingBooks.forEach(t=>{t.userData&&t.userData.glowMeshes&&t.userData.glowMeshes.forEach(t=>{animateGlowOpacity(t,e?t.userData.originalOpacity:0)})})}function animateGlowOpacity(e,t,o=300){if(!e.material)return;e.userData.animationId&&cancelAnimationFrame(e.userData.animationId);const s=e.material.opacity,a=Date.now();!function n(){const i=Date.now()-a,r=Math.min(i/o,1),l=r<.5?4*r*r*r:1-Math.pow(-2*r+2,3)/2,c=s+(t-s)*l;e.material.opacity=c,e.visible=!0,r<1?e.userData.animationId=requestAnimationFrame(n):(e.userData.animationId=null,0===t&&(e.visible=!1))}()}function animateGlowingBooks(){window.glowingBooks&&window.glowingBooks.forEach(e=>{})}function animateSunlightBeams(){window.sunlightBeams&&window.sunlightBeams.forEach(e=>{e.children.forEach(e=>{if(e.userData&&e.material){const t=.001*Date.now(),o=.3*Math.sin(t*e.userData.animationSpeed+e.userData.animationOffset)+.7;e.material.opacity=e.userData.originalOpacity*o}})})}function createWindow(){const e=new THREE.PlaneGeometry(1.2,3),t=new THREE.MeshLambertMaterial({color:8900331,transparent:!0,opacity:.85,side:THREE.DoubleSide}),o=new THREE.Mesh(e,t);o.position.set(-5.15,2,-1.5),o.rotation.y=Math.PI/2,room.add(o)}function createSunlightBeams(){const e=new THREE.Group;e.name="sunlightBeams";for(let t=0;t<4;t++){const o=2.5*(.7+.6*Math.random()),s=new THREE.BoxGeometry(.03,.05,o),a=new THREE.MeshBasicMaterial({color:16775408,transparent:!0,opacity:.1+.15*Math.random(),side:THREE.DoubleSide,blending:THREE.NormalBlending,depthWrite:!1}),n=new THREE.Mesh(s,a),i=1.2*(Math.random()-.5)*.6,r=3*(Math.random()-.5)*.4;n.position.set(-4.15,2+r,-1.5+i+.25);const l=-300,c=-20,d=-25-n.position.x,m=l-n.position.y,u=c-n.position.z,h=Math.atan2(d,u)+.15,p=-Math.atan2(m,Math.sqrt(d*d+u*u))-Math.PI/5+.2*(Math.random()-.5);n.rotation.set(p,h,0),n.scale.set(1,1,1),n.userData={originalOpacity:a.opacity,animationOffset:t/4*Math.PI*2,animationSpeed:.3},e.add(n)}room.add(e),window.sunlightBeams||(window.sunlightBeams=[]),window.sunlightBeams.push(e),console.log("Streamlined sunlight beams created successfully!")}function animate(){animationId=requestAnimationFrame(animate),cameraAngleX+=.1*(targetCameraAngleX-cameraAngleX),cameraAngleY+=.1*(targetCameraAngleY-cameraAngleY),cameraDistance+=.1*(targetCameraDistance-cameraDistance),updateCameraPosition(),animateGlowingBooks(),animateSunlightBeams(),renderer&&scene&&camera?renderer.render(scene,camera):console.error("Renderer, scene, or camera not initialized!")}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),composer&&composer.setSize(window.innerWidth,window.innerHeight)}function initModal(){const e=document.getElementById("navigation-modal"),t=document.querySelectorAll(".nav-link"),o=(document.querySelectorAll(".content-section"),document.getElementById("close-modal"));e&&(e.addEventListener("mouseenter",()=>{setGlowVisibility(!1)}),e.addEventListener("mouseleave",()=>{setGlowVisibility(!0)})),t.forEach(e=>{e.addEventListener("mouseenter",()=>{setGlowVisibility(!1)}),e.addEventListener("mouseleave",()=>{setGlowVisibility(!0)})}),e&&(e.style.display="block"),t.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();showContentSection(e.getAttribute("href").substring(1))})}),o&&o.addEventListener("click",()=>{hideAllContentSections()}),e&&e.addEventListener("click",t=>{t.target===e&&hideAllContentSections()});const s=document.querySelector(".scrapbook-modal");s&&s.addEventListener("click",e=>{e.target===s&&setTimeout(()=>{hideAllContentSections()},100)});const a=document.querySelector(".desktop-modal");a&&a.addEventListener("click",e=>{(e.target===a||e.target.classList.contains("close-instruction"))&&hideAllContentSections()}),initProjectFolders();const n=document.querySelector(".resume-preview-modal");n&&n.addEventListener("click",e=>{(e.target===n||e.target.classList.contains("close-instruction"))&&hideAllContentSections()});const i=document.querySelector(".education-modal");i&&i.addEventListener("click",e=>{(e.target===i||e.target.classList.contains("close-instruction"))&&hideAllContentSections()});const r=document.querySelector(".contact-modal");r&&r.addEventListener("click",e=>{(e.target===r||e.target.classList.contains("close-instruction"))&&hideAllContentSections()}),document.addEventListener("click",e=>{const t=document.querySelector(".content-section.active");if(t){const o=t.querySelector(".scrapbook-content, .desktop-window, .resume-preview-content, .education-content, .contact-content");!o||o.contains(e.target)||e.target.closest(".nav-link")||hideAllContentSections()}})}function showContentSection(e){hideAllContentSections(),hideMusicPlayer(),setTimeout(()=>{const t=document.getElementById(e);t&&(t.classList.add("active"),"experience"===e&&console.log("Experience section opened - music player should be hidden"))},50)}function hideAllContentSections(){document.querySelectorAll(".content-section").forEach(e=>{e.classList.contains("active")&&(e.style.animation="modalFadeOut 0.3s cubic-bezier(0.4, 0, 0.2, 1)",setTimeout(()=>{e.classList.remove("active"),e.style.animation="",showMusicPlayer()},300))})}function hideMusicPlayer(){const e=document.querySelector(".music-player");e&&(e.style.display="none")}function showMusicPlayer(){const e=document.querySelector(".music-player");e&&(e.style.display="block")}function initAudioPlayer(){const e=document.getElementById("play-pause"),t=(document.getElementById("progress"),document.getElementById("current-time"),document.getElementById("duration"),document.getElementById("volume"));let o=!1;e.addEventListener("click",()=>{o=!o;e.querySelector("i").className=o?"fas fa-pause":"fas fa-play"}),t.addEventListener("input",e=>{console.log("Volume:",e.target.value)})}function waitForThreeJS(){"undefined"!=typeof THREE?(console.log("Three.js loaded successfully!"),init3D()):(console.log("Waiting for Three.js to load..."),setTimeout(waitForThreeJS,100))}document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded, initializing..."),waitForThreeJS(),initModal(),initAudioPlayer(),initMusicPlayer(),window.addEventListener("resize",onWindowResize)});class SpotifyMusicPlayer{constructor(){this.clientId="b3629d1eb6a34dbd91aed2ef24c497f1",this.redirectUri=window.location.origin+"/",this.accessToken=null,this.currentTrack=null,this.audio=null,this.isPlaying=!1,this.isExpanded=!1,this.isLoggedIn=!1,this.defaultTrackId="5VBjyOQzqlPNgdRPMM6prF",this.defaultAudioUrl="https://p.scdn.co/mp3-preview/5VBjyOQzqlPNgdRPMM6prF?cid=b3629d1eb6a34dbd91aed2ef24c497f1",this.initializeElements(),this.setupEventListeners(),this.initializeDefaultMusic(),this.setupResponsiveHandling()}initializeElements(){this.musicToggle=document.getElementById("music-toggle"),this.musicContent=document.getElementById("music-content"),console.log("Music toggle found:",this.musicToggle),console.log("Music content found:",this.musicContent),this.musicTitle=document.querySelector(".music-title"),this.spotifyLogin=document.getElementById("spotify-login"),this.musicPlayerContent=document.getElementById("music-player-content"),this.spotifyLoginBtn=document.getElementById("spotify-login-btn"),this.searchInput=document.getElementById("search-input"),this.searchBtn=document.getElementById("search-btn"),this.searchResults=document.getElementById("search-results"),this.resultsList=document.getElementById("results-list"),this.trackTitle=document.getElementById("track-title"),this.trackArtist=document.getElementById("track-artist"),this.albumArt=document.getElementById("album-art"),this.playPauseBtn=document.getElementById("play-pause"),this.rewindBtn=document.getElementById("rewind"),this.forwardBtn=document.getElementById("forward"),this.volumeSlider=document.getElementById("volume"),this.progressBar=document.getElementById("progress"),this.currentTimeSpan=document.getElementById("current-time"),this.durationSpan=document.getElementById("duration")}setupEventListeners(){this.musicToggle.addEventListener("click",e=>{console.log("Music toggle clicked!"),e.stopPropagation(),this.toggleExpanded()}),this.musicTitle.addEventListener("click",e=>{console.log("Now Playing clicked!"),e.stopPropagation(),this.toggleExpanded()}),this.musicTitle.style.cursor="pointer",this.musicTitle.style.userSelect="none",this.spotifyLoginBtn.addEventListener("click",()=>{this.loginToSpotify()}),this.searchBtn.addEventListener("click",()=>{this.searchTracks()}),this.searchInput.addEventListener("keypress",e=>{"Enter"===e.key&&this.searchTracks()}),this.playPauseBtn.addEventListener("click",()=>{this.togglePlayPause()}),this.rewindBtn.addEventListener("click",()=>{this.previousTrack()}),this.forwardBtn.addEventListener("click",()=>{this.nextTrack()}),this.volumeSlider.addEventListener("input",e=>{this.setVolume(e.target.value)}),this.progressBar.addEventListener("click",e=>{this.seekTo(e)}),this.checkForAccessToken()}toggleExpanded(){console.log("Toggle expanded called, current state:",this.isExpanded),console.log("Music content element:",this.musicContent),this.isExpanded=!this.isExpanded,this.isExpanded?(this.musicContent.classList.add("show"),this.musicToggle.innerHTML='<i class="fas fa-chevron-up"></i>',console.log("Music player expanded")):(this.musicContent.classList.remove("show"),this.musicToggle.innerHTML='<i class="fas fa-music"></i>',console.log("Music player collapsed"))}initializeDefaultMusic(){const e=window.innerWidth<=768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=window.innerWidth<1024;e||t?(this.isExpanded=!1,this.musicContent.classList.remove("show"),this.musicToggle.innerHTML='<i class="fas fa-music"></i>'):(this.isExpanded=!0,this.showDefaultEmbed())}playDefaultTrack(){this.trackTitle.textContent="seasons",this.trackArtist.textContent="wave to earth",this.updateHeaderNowPlaying("seasons"),this.showDefaultEmbed()}showDefaultEmbed(){this.musicContent.classList.add("show"),this.musicToggle.innerHTML='<i class="fas fa-chevron-up"></i>';let e=document.getElementById("spotify-default-embed");e||(e=document.createElement("iframe"),e.id="spotify-default-embed",e.setAttribute("data-testid","embed-iframe"),e.style.borderRadius="12px",e.width="100%",e.height="152",e.frameBorder="0",e.allowFullscreen=!0,e.allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",e.loading="lazy",this.musicContent.appendChild(e)),e.src=`https://open.spotify.com/embed/track/${this.defaultTrackId}?utm_source=generator`,this.musicPlayerContent.style.display="none",this.spotifyLogin.style.display="none",this.createCompactLoginButton()}createCompactLoginButton(){const e=document.getElementById("compact-login-btn");e&&e.remove();const t=document.createElement("button");t.id="compact-login-btn",t.innerHTML='<i class="fab fa-spotify"></i> Login to Spotify',t.style.background="rgba(255, 255, 255, 0.9)",t.style.color="#ff69b4",t.style.border="none",t.style.borderRadius="20px",t.style.padding="8px 16px",t.style.fontWeight="600",t.style.fontSize="13px",t.style.cursor="pointer",t.style.transition="all 0.3s ease",t.style.boxShadow="0 2px 8px rgba(255, 105, 180, 0.2)",t.style.margin="10px auto",t.style.display="block",t.addEventListener("mouseenter",()=>{t.style.background="white",t.style.color="#ff1493",t.style.transform="translateY(-2px)",t.style.boxShadow="0 4px 12px rgba(255, 105, 180, 0.3)"}),t.addEventListener("mouseleave",()=>{t.style.background="rgba(255, 255, 255, 0.9)",t.style.color="#ff69b4",t.style.transform="translateY(0)",t.style.boxShadow="0 2px 8px rgba(255, 105, 180, 0.2)"}),t.addEventListener("click",()=>{this.loginToSpotify()});const o=document.getElementById("spotify-default-embed");o&&o.parentNode&&o.parentNode.insertBefore(t,o.nextSibling)}setupResponsiveHandling(){window.addEventListener("resize",()=>{const e=window.innerWidth<=768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=window.innerWidth<1024;(e||t)&&this.isExpanded&&this.toggleExpanded()})}async loginToSpotify(){const e=this.generateCodeVerifier(),t=await this.generateCodeChallenge(e);sessionStorage.setItem("spotify_code_verifier",e);const o=new URLSearchParams({client_id:this.clientId,response_type:"code",redirect_uri:this.redirectUri,scope:"user-read-private user-read-email user-top-read user-read-recently-played",code_challenge_method:"S256",code_challenge:t});window.location.href=`https://accounts.spotify.com/authorize?${o.toString()}`}async checkForAccessToken(){const e=new URLSearchParams(window.location.search).get("code");if(e)try{return await this.exchangeCodeForToken(e),this.showMusicPlayer(),void window.history.replaceState({},document.title,window.location.pathname)}catch(e){console.error("PKCE token exchange failed:",e)}const t=window.location.hash,o=new URLSearchParams(t.substring(1)).get("access_token");o?(this.accessToken=o,this.showMusicPlayer(),window.history.replaceState({},document.title,window.location.pathname)):this.showLoginInterface()}showLoginInterface(){this.isLoggedIn=!1,this.spotifyLogin.style.display="block",this.musicPlayerContent.style.display="none",this.spotifyLogin.style.padding="",this.spotifyLogin.style.textAlign="",this.spotifyLogin.style.background="",this.spotifyLogin.style.borderRadius="",this.spotifyLogin.style.marginTop="",this.spotifyLogin.style.border="",this.spotifyLogin.style.boxShadow="";const e=this.spotifyLogin.querySelector("button");e&&(e.style.background="",e.style.color="",e.style.border="",e.style.borderRadius="",e.style.padding="",e.style.fontWeight="",e.style.fontSize="",e.style.cursor="",e.style.transition="",e.style.boxShadow="",e.style.transform=""),this.removeDefaultEmbed()}async exchangeCodeForToken(e){const t=sessionStorage.getItem("spotify_code_verifier");if(!t)throw new Error("Missing PKCE code_verifier in sessionStorage");const o=new URLSearchParams({client_id:this.clientId,grant_type:"authorization_code",code:e,redirect_uri:this.redirectUri,code_verifier:t}),s=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o.toString()}),a=await s.json();if(!s.ok)throw new Error(a.error_description||JSON.stringify(a));this.accessToken=a.access_token}generateCodeVerifier(){const e=new Uint8Array(32);return window.crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async generateCodeChallenge(e){const t=(new TextEncoder).encode(e),o=await window.crypto.subtle.digest("SHA-256",t),s=new Uint8Array(o);let a="";for(let e=0;e<s.byteLength;e++)a+=String.fromCharCode(s[e]);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}showMusicPlayer(){this.isLoggedIn=!0,this.spotifyLogin.style.display="none",this.musicPlayerContent.style.display="block",this.removeDefaultEmbed(),this.updateHeaderNowPlaying(),!this.currentTrack&&this.accessToken&&this.defaultTrackId&&this.playTrack(this.defaultTrackId)}removeDefaultEmbed(){const e=document.getElementById("spotify-default-embed");e&&e.parentNode&&e.parentNode.removeChild(e);const t=document.getElementById("compact-login-btn");t&&t.parentNode&&t.parentNode.removeChild(t),this.toggleCustomPlayerVisibility(!0)}async searchTracks(){const e=this.searchInput.value.trim();if(e&&this.isLoggedIn&&this.accessToken)try{const t=await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track&limit=10`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),o=await t.json();this.displaySearchResults(o.tracks.items)}catch(e){console.error("Search error:",e)}}displaySearchResults(e){this.resultsList.innerHTML="",this.searchResults.style.display="block",e.forEach(e=>{const t=document.createElement("div");t.className="result-item",t.innerHTML=`\n        <img src="${e.album.images[0]?.url||""}" alt="Album Art" onerror="this.style.display='none'">\n        <div class="result-info">\n          <div class="result-title">${e.name}</div>\n          <div class="result-artist">${e.artists[0].name}</div>\n        </div>\n        <button class="play-preview" onclick="musicPlayer.playTrack('${e.id}')">\n          <i class="fas fa-play"></i>\n        </button>\n      `,this.resultsList.appendChild(t)})}async playTrack(e){if(this.isLoggedIn&&this.accessToken)try{const t=await fetch(`https://api.spotify.com/v1/tracks/${e}`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),o=await t.json();this.currentTrack=o,this.updateTrackDisplay(),o.preview_url?(this.playPreview(o.preview_url),this.removeEmbedIfAny()):this.showEmbed(o.id)}catch(e){console.error("Track fetch error:",e)}else console.log("User not logged in, cannot play track")}playPreview(e){this.audio&&this.audio.pause(),this.audio=new Audio(e),this.audio.volume=this.volumeSlider.value/100,this.audio.addEventListener("loadedmetadata",()=>{this.durationSpan.textContent=this.formatTime(this.audio.duration)}),this.audio.addEventListener("timeupdate",()=>{this.updateProgress()}),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'}),this.audio.play().catch(e=>{console.log("Autoplay prevented:",e),this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'}),this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'}updateTrackDisplay(){if(!this.currentTrack)return;this.trackTitle.textContent=this.currentTrack.name,this.trackArtist.textContent=this.currentTrack.artists[0].name,this.updateHeaderNowPlaying(this.currentTrack.name);const e=this.albumArt.querySelector("img");e?e.src=this.currentTrack.album.images[0]?.url||"":this.albumArt.innerHTML=`<img src="${this.currentTrack.album.images[0]?.url||""}" alt="Album Art" onerror="this.innerHTML='ðŸŽµ'">`}updateHeaderNowPlaying(e){this.musicTitle&&(e&&e.trim().length>0?this.musicTitle.textContent=`Now Playing â€” ${e}`:this.musicTitle.textContent="Now Playing")}showEmbed(e){let t=document.getElementById("spotify-embed");t||(t=document.createElement("iframe"),t.id="spotify-embed",t.style.borderRadius="12px",t.width="100%",t.height="152",t.frameBorder="0",t.allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",t.loading="lazy",this.musicPlayerContent.prepend(t)),t.src=`https://open.spotify.com/embed/track/${e}?utm_source=generator`,this.toggleCustomPlayerVisibility(!1)}removeEmbedIfAny(){const e=document.getElementById("spotify-embed");e&&e.parentNode&&e.parentNode.removeChild(e),this.toggleCustomPlayerVisibility(!0)}toggleCustomPlayerVisibility(e){[document.querySelector(".track-info"),document.querySelector(".music-controls"),document.querySelector(".volume-control"),document.querySelector(".progress-container")].forEach(t=>{t&&(t.style.display=e?"":"none")})}togglePlayPause(){this.audio&&(this.isPlaying?(this.audio.pause(),this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'):(this.audio.play(),this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'))}previousTrack(){this.audio&&(this.audio.currentTime=0)}nextTrack(){this.audio&&(this.audio.currentTime=0)}setVolume(e){this.audio&&(this.audio.volume=e/100);const t=document.querySelector(".volume-control i");t.className=0==e?"fas fa-volume-mute":e<50?"fas fa-volume-down":"fas fa-volume-up"}seekTo(e){if(!this.audio)return;const t=this.progressBar.getBoundingClientRect(),o=(e.clientX-t.left)/t.width*this.audio.duration;this.audio.currentTime=o}updateProgress(){if(!this.audio)return;const e=this.progressBar.querySelector(".progress"),t=this.audio.currentTime/this.audio.duration*100;e.style.width=`${t}%`,this.currentTimeSpan.textContent=this.formatTime(this.audio.currentTime)}formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}}function initMusicPlayer(){musicPlayer=new SpotifyMusicPlayer}function initProjectFolders(){const e=document.querySelectorAll(".project-folder"),t={goldenbook:"https://goldenbookofficial.vercel.app/","triangle-completion":"https://github.com/sabpdo/Unity-Triangle_Completion","leftover-love":"https://leftover-love.vercel.app/welcome","eco-calc":"https://devpost.com/software/eco-calc",compiler:"https://github.com/6110-sp25/sp25-team1-waffle",qoom:"https://kindswan26.qoom.space/edit/Unnamed/index.html",portfolio:"#",more:"https://github.com/sabpdo"};e.forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation();const s=e.getAttribute("data-project"),a=t[s];a&&"#"!==a?(e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="",window.open(a,"_blank")},150)):"portfolio"===s&&hideAllContentSections()}),e.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.click())}),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.setAttribute("aria-label",`Open ${e.querySelector(".folder-name").textContent} project`)})}function initBriefcaseAnimations(){document.querySelector(".briefcase-modal");const e=document.querySelectorAll(".experience-card"),t=document.querySelectorAll(".stat-badge"),o=document.querySelectorAll(".company-logo"),s=document.querySelectorAll(".tech-tag");document.querySelectorAll(".highlight-item");e.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{e.style.boxShadow="0 25px 50px rgba(102, 126, 234, 0.2), 0 0 0 1px rgba(102, 126, 234, 0.3)";const t=e.querySelector(".company-logo");t&&(t.style.transform="scale(1.15) rotate(10deg)",t.style.transition="transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)");e.querySelectorAll(".tech-tag").forEach((e,t)=>{setTimeout(()=>{e.style.transform="translateY(-3px) scale(1.05)",e.style.transition="transform 0.2s ease"},50*t)});e.querySelectorAll(".highlight-item").forEach((e,t)=>{setTimeout(()=>{e.style.transform="translateY(-2px) scale(1.02)",e.style.transition="transform 0.2s ease"},100*t)})}),e.addEventListener("mouseleave",()=>{e.style.boxShadow="";const t=e.querySelector(".company-logo");t&&(t.style.transform="");e.querySelectorAll(".tech-tag").forEach(e=>{e.style.transform=""});e.querySelectorAll(".highlight-item").forEach(e=>{e.style.transform=""})})}),t.forEach(e=>{e.addEventListener("click",()=>{e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform=""},150)})}),o.forEach(e=>{e.addEventListener("click",t=>{const o=document.createElement("div"),s=e.getBoundingClientRect(),a=Math.max(s.width,s.height),n=t.clientX-s.left-a/2,i=t.clientY-s.top-a/2;o.style.cssText=`\n        position: absolute;\n        width: ${a}px;\n        height: ${a}px;\n        left: ${n}px;\n        top: ${i}px;\n        background: rgba(255, 255, 255, 0.3);\n        border-radius: 50%;\n        transform: scale(0);\n        animation: ripple 0.6s ease-out;\n        pointer-events: none;\n      `,e.style.position="relative",e.style.overflow="hidden",e.appendChild(o),setTimeout(()=>{o.remove()},600)})});const a=document.createElement("style");a.textContent="\n    @keyframes ripple {\n      to {\n        transform: scale(2);\n        opacity: 0;\n      }\n    }\n  ",document.head.appendChild(a),s.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{e.style.transform="translateY(-4px) scale(1.1)",e.style.boxShadow="0 8px 20px rgba(102, 126, 234, 0.3)"}),e.addEventListener("mouseleave",()=>{e.style.transform="",e.style.boxShadow=""})});document.querySelectorAll(".achievement-description p").forEach((e,t)=>{const o=e.textContent;e.textContent="",e.style.borderRight="2px solid #667eea",e.style.animation="blink 1s infinite",setTimeout(()=>{let t=0;const s=()=>{t<o.length?(e.textContent+=o.charAt(t),t++,setTimeout(s,20)):(e.style.borderRight="none",e.style.animation="none")};s()},2e3+1e3*t)});const n=document.createElement("style");n.textContent="\n    @keyframes blink {\n      0%, 50% { border-color: #667eea; }\n      51%, 100% { border-color: transparent; }\n    }\n  ",document.head.appendChild(n)}function toggleSection(e){const t=document.getElementById(e+"-content"),o=document.querySelector(`[onclick="toggleSection('${e}')"]`),s=o.querySelector("i");t.classList.contains("collapsed")?(t.classList.remove("collapsed"),o.classList.remove("collapsed"),setTimeout(()=>{s.style.transform="rotate(0deg)"},50)):(t.classList.add("collapsed"),o.classList.add("collapsed"),s.style.transform="rotate(-90deg)")}function closeBriefcaseModal(){const e=document.getElementById("experience");e&&(e.classList.remove("active"),showMusicPlayer())}window.onSpotifyWebPlaybackSDKReady=window.onSpotifyWebPlaybackSDKReady||function(){},document.addEventListener("DOMContentLoaded",()=>{initBriefcaseAnimations()}),window.addEventListener("beforeunload",()=>{animationId&&cancelAnimationFrame(animationId)});