let scene,camera,renderer,room,animationId,composer,bloomPass,objLoader,gltfLoader,fbxLoader,mouseX=0,mouseY=0,isMouseDown=!1,targetRotationX=0,targetRotationY=0,rotationX=0,rotationY=0,cameraDistance=5,targetCameraDistance=5,cameraAngleX=0,cameraAngleY=0,targetCameraAngleX=0,targetCameraAngleY=0,isTouching=!1,lastTouchX=0,lastTouchY=0,touchStartX=0,touchStartY=0,touchStartAngleX=0,touchStartAngleY=0,initialDistance=0,initialCameraDistance=0,loadedAssets={},hoveredMenuMesh=null;const MENU_HOVER_SCALE_DESKTOP=1.1;let mobile3DMenu=null,isMobile3DMenuActive=!1,mobileMenuButtons=[],mobileMenuGroup=null;const SATURATION_BOOST=1.8;function isMobileScreen(){return window.innerWidth<=480||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function boostColorSaturation(e,t){if(!e||"function"!=typeof e.getHSL)return;const o={h:0,s:0,l:0};e.getHSL(o),o.s=Math.min(1,o.s*t),e.setHSL(o.h,o.s,o.l)}function boostMaterialSaturation(e,t){e&&(Array.isArray(e)?e.forEach(e=>boostMaterialSaturation(e,t)):e.color&&(boostColorSaturation(e.color,t),e.needsUpdate=!0))}function boostSaturationOnGroup(e,t=1.8){e&&e.traverse&&e.traverse(e=>{e.isMesh&&e.material&&boostMaterialSaturation(e.material,t)})}function increaseBrightnessOnGroup(e,t=1.15){e&&e.traverse&&e.traverse(e=>{if(e.isMesh&&e.material){const o=e=>{e&&e.color&&(e.color.multiplyScalar(t),e.needsUpdate=!0)};Array.isArray(e.material)?e.material.forEach(o):o(e.material)}})}function init3D(){const e=document.getElementById("room-canvas");if(!e)return void console.error("Canvas element not found!");if("undefined"==typeof THREE)return void console.error("Three.js not loaded!");console.log("Initializing 3D scene..."),scene=new THREE.Scene,scene.background=new THREE.Color(16777215),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),cameraAngleX=.4,cameraAngleY=.1,targetCameraAngleX=.4,targetCameraAngleY=.4,cameraDistance=13,targetCameraDistance=13,updateCameraPosition(),renderer=new THREE.WebGLRenderer({canvas:e,antialias:!0}),renderer.setSize(window.innerWidth,window.innerHeight),renderer.outputEncoding=THREE.sRGBEncoding,renderer.toneMapping=THREE.ACESFilmicToneMapping,renderer.toneMappingExposure=1,renderer.physicallyCorrectLights=!0,renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,setupBloomEffect();const t=new THREE.AmbientLight(16771276,.4);scene.add(t);const o=new THREE.DirectionalLight(16770764,1);o.position.set(5,5,5),o.castShadow=!0,o.shadow.mapSize.width=2048,o.shadow.mapSize.height=2048,scene.add(o),createBasicRoom(),animate(),addMouseControls(),waitForLoadersAndLoadAssets(),setTimeout(()=>{hideLoadingScreen()},1500)}function hideLoadingScreen(){const e=document.getElementById("loading-screen");e&&setTimeout(()=>{e.classList.add("hidden"),document.body.classList.remove("loading"),enableBodyScroll(),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},500)},2e3)}function updateCameraPosition(){const e=cameraDistance*Math.sin(cameraAngleY)*Math.cos(cameraAngleX),t=cameraDistance*Math.sin(cameraAngleX),o=cameraDistance*Math.cos(cameraAngleY)*Math.cos(cameraAngleX);camera.position.set(e,t,o),camera.lookAt(0,0,0)}function initLoaders(){void 0!==THREE.OBJLoader&&(objLoader=new THREE.OBJLoader),void 0!==THREE.GLTFLoader&&(gltfLoader=new THREE.GLTFLoader),void 0!==THREE.FBXLoader&&(fbxLoader=new THREE.FBXLoader)}function waitForLoadersAndLoadAssets(){const e=()=>{void 0!==THREE.GLTFLoader?(console.log("GLTF Loader is now available, initializing loaders..."),initLoaders(),loadAssets().then(()=>{updateRoomWithNewAssets()})):(console.log("Waiting for GLTF Loader to be available..."),setTimeout(e,100))};e()}let musicPlayer,totalAssets=0,loadedAssetsCount=0;function updateProgress(){const e=document.getElementById("progress-fill"),t=document.getElementById("progress-text");if(e&&t){const o=Math.round(loadedAssetsCount/totalAssets*100);e.style.width=`${o}%`,t.textContent=`${o}%`}}async function loadAssets(){console.log("Loading 3D assets progressively...");const e=[{name:"table",path:"asset_glb/table.glb",type:"gltf",priority:"high"},{name:"laptop",path:"asset_glb/laptop.glb",type:"gltf",priority:"high"},{name:"chair",path:"asset_glb/chairDesk.glb",type:"gltf",priority:"high"}],t=[{name:"table2",path:"asset_glb/table.glb",type:"gltf",priority:"medium"},{name:"lamp",path:"asset_glb/lampRoundTable.glb",type:"gltf",priority:"medium"},{name:"books",path:"asset_glb/books.glb",type:"gltf",priority:"medium"},{name:"newBed",path:"asset_glb/cute_stylized_bed_-_low_poly_-_game_ready.glb",type:"gltf",priority:"medium"}],o=[{name:"cake",path:"asset_glb/strawberry_cake.glb",type:"gltf",priority:"low"},{name:"bunny",path:"asset_glb/bunny_plush_toy.glb",type:"gltf",priority:"low"},{name:"indoorPlantNew",path:"asset_glb/indoor_plant.glb",type:"gltf",priority:"low"},{name:"stringLightsNew",path:"asset_glb/simple_string_lights.glb",type:"gltf",priority:"low"},{name:"windowAsset",path:"asset_glb/window.glb",type:"gltf",priority:"low"}];totalAssets=e.length+t.length+o.length,loadedAssetsCount=0;try{console.log("Loading critical assets..."),await Promise.all(e.map(e=>loadAssetWithProgress(e))),console.log("Critical assets loaded successfully!"),setTimeout(()=>{console.log("Loading secondary assets..."),t.forEach(e=>loadAssetWithProgress(e))},100),setTimeout(()=>{console.log("Loading decorative assets..."),o.forEach(e=>loadAssetWithProgress(e))},500)}catch(e){console.warn("Some critical assets failed to load:",e)}}function loadAssetWithProgress(e){return loadAsset(e).then(()=>{loadedAssetsCount++,updateProgress(),updateRoomWithNewAssets()}).catch(()=>{loadedAssetsCount++,updateProgress()})}function updateRoomWithNewAssets(){console.log("Updating room with newly loaded assets..."),addMissingAssetsToRoom(),updateMirrorRoom()}function updateMirrorRoom(){if(!window.mirroredRoom)return console.warn("Mirrored room not found, recreating..."),void createMirrorReflection();const e=[];room.traverse(t=>{t.name&&""!==t.name&&t!==room&&e.push(t)}),e.forEach(e=>{window.mirroredRoom.getObjectByName(e.name)||addAssetToMirror(e)})}function addMissingAssetsToRoom(){let e=null;loadedAssets.newBed&&!room.getObjectByName("bed")?(e=prepareAsset(loadedAssets.newBed),console.log("Using cute stylized bed")):loadedAssets.bed&&!room.getObjectByName("bed")&&(e=prepareAsset(loadedAssets.bed),console.log("Using regular bed")),e&&(e.name="bed",e.position.set(-1.95,-1.75,-4.5),e.scale.set(3,3,3),e.rotation.y=4.75,room.add(e),increaseBrightnessOnGroup(e,.97),console.log("Added bed to room"));const t=prepareAsset(loadedAssets.table);t&&!room.getObjectByName("desk")&&(t.name="desk",t.position.set(1.5,-2.2,-3.5),t.scale.set(3,6.75,3),t.rotation.y=0,room.add(t),console.log("Added desk to room"));const o=prepareAsset(loadedAssets.laptop);o&&!room.getObjectByName("laptop")&&(o.name="laptop",o.position.set(2,0,-3.8),o.scale.set(4,4,4),o.rotation.y=0,addGlowEffectToBooks(o),room.add(o),console.log("Added laptop to room"));const s=prepareAsset(loadedAssets.chair);s&&!room.getObjectByName("chair")&&(s.name="chair",s.position.set(3.5,-2,-3.5),s.scale.set(4.5,4.5,4.5),s.rotation.y=Math.PI,boostSaturationOnGroup(s,1.05),room.add(s),console.log("Added chair to room"));const n=prepareAsset(loadedAssets.lamp);n&&!room.getObjectByName("lamp")&&(n.name="lamp",n.position.set(3.2,0,-4),n.scale.set(3.75,3.75,3.75),room.add(n),console.log("Added lamp to room"));const i=prepareAsset(loadedAssets.books);i&&!room.getObjectByName("books")&&(i.name="books",i.position.set(2,1.55,-4),i.scale.set(10,10,10),boostSaturationOnGroup(i,1.45),addGlowEffectToBooks(i),room.add(i),console.log("Added books to room"));const a=prepareAsset(loadedAssets.indoorPlantNew);a&&!room.getObjectByName("shelfPlant")&&(a.name="shelfPlant",a.position.set(1.5,1.55,-4.35),a.scale.set(1,1,1),a.rotation.y=-Math.PI/12,boostSaturationOnGroup(a,1.4),room.add(a),console.log("Added shelf plant to room"));const r=prepareAsset(loadedAssets.table2);r&&!room.getObjectByName("table2")&&(r.name="table2",r.position.set(-4.8,-2.2,3.75),r.scale.set(1.75,7,3.5),r.rotation.y=0,room.add(r),console.log("Added second table to room")),createShelves(),addDecorativeAssets()}function addDecorativeAssets(){if(loadedAssets.cake&&!room.getObjectByName("cake")){const e=prepareAsset(loadedAssets.cake);e&&(e.name="cake",e.position.set(-3.9,0,3),e.scale.set(.5,.75,.5),e.rotation.y=Math.PI/4,e.traverse(e=>{e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1)}),addCakeGlowEffect(e),room.add(e),console.log("Added cake to room"))}if(loadedAssets.bunny&&!room.getObjectByName("bunny")){const e=prepareAsset(loadedAssets.bunny);e&&(e.name="bunny",e.position.set(-2.15,.15,-1.5),e.scale.set(2,2,2),e.rotation.y=Math.PI/6,increaseBrightnessOnGroup(e,7),e.traverse&&e.traverse(e=>{if(e.isMesh&&(e.castShadow=!1,e.receiveShadow=!1,e.material)){const t=Array.isArray(e.material)?e.material[0]?.map:e.material.map,o=new THREE.MeshLambertMaterial({color:16777215,map:t||null});e.material=o}}),addGlowEffectToBooks(e),room.add(e),console.log("Added bunny to room"))}if(loadedAssets.stringLightsNew&&!room.getObjectByName("stringLights")){const e=prepareAsset(loadedAssets.stringLightsNew);if(e){const t=e.clone();t.name="stringLights",increaseBrightnessOnGroup(t,10),t.position.set(-1.75,3.45,-4.8),t.scale.set(.5,1,2),addGlowEffectToBooks(t),room.add(t),console.log("Added string lights to room")}}if(loadedAssets.windowAsset&&!room.getObjectByName("windowAsset")){const e=prepareAsset(loadedAssets.windowAsset);e&&(e.name="windowAsset",e.position.set(-7.71,-.5,1.5),e.rotation.y=Math.PI,e.scale.set(.05,.05,.05),room.add(e),console.log("Added window asset to room"))}}function loadAsset(e){return new Promise((t,o)=>{let s;if(console.log(`Loading ${e.name}...`),"gltf"===e.type&&gltfLoader)s=gltfLoader;else if("fbx"===e.type&&fbxLoader)s=fbxLoader;else{if("obj"!==e.type||!objLoader)return console.warn(`No suitable loader for ${e.name} (${e.type})`),loadedAssets[e.name]=createGenericPlaceholder(),void t();s=objLoader}s.load(e.path,o=>{"gltf"===e.type?(loadedAssets[e.name]=o.scene,console.log(`Successfully loaded ${e.name} - Type: ${o.scene.type}, Children: ${o.scene.children.length}`)):(loadedAssets[e.name]=o,console.log(`Successfully loaded ${e.name} - Type: ${o.type}, Children: ${o.children?o.children.length:"N/A"}`)),t()},void 0,o=>{console.error(`Error loading ${e.name}:`,o),loadedAssets[e.name]=createGenericPlaceholder(),t()})})}function createGenericPlaceholder(){const e=new THREE.Group,t=new THREE.BoxGeometry(1,1,1),o=new THREE.MeshLambertMaterial({color:8947848}),s=new THREE.Mesh(t,o);return e.add(s),e}function addMouseControls(){const e=document.getElementById("room-canvas");e.addEventListener("mousedown",t=>{isMouseDown=!0,mouseX=t.clientX,mouseY=t.clientY,e.style.cursor="grabbing"}),e.addEventListener("mouseup",t=>{if(isMouseDown=!1,e.style.cursor="grab",mobileMenuGroup&&mobileMenuGroup.visible){const e=new THREE.Vector2;e.x=t.clientX/window.innerWidth*2-1,e.y=-t.clientY/window.innerHeight*2+1;const o=new THREE.Raycaster;o.setFromCamera(e,camera);const s=o.intersectObjects(mobileMenuButtons,!0);s.length>0&&handle3DMenuClick(s[0].object)}}),e.addEventListener("mousemove",t=>{if(!isMobileScreen()&&mobileMenuGroup&&mobileMenuGroup.visible&&mobileMenuButtons.length>0){const o=new THREE.Vector2;o.x=t.clientX/window.innerWidth*2-1,o.y=-t.clientY/window.innerHeight*2+1;const s=new THREE.Raycaster;s.setFromCamera(o,camera);const n=s.intersectObjects(mobileMenuButtons,!0);if(n.length>0){const t=n[0].object;hoveredMenuMesh&&hoveredMenuMesh!==t&&hoveredMenuMesh.scale.set(1,1,1),hoveredMenuMesh=t,hoveredMenuMesh.scale.set(1.1,1.1,1.1),e.style.cursor="pointer"}else hoveredMenuMesh&&(hoveredMenuMesh.scale.set(1,1,1),hoveredMenuMesh=null,e.style.cursor="grab")}if(isMouseDown){const e=t.clientX-mouseX,o=t.clientY-mouseY;targetCameraAngleY-=.01*e,targetCameraAngleX+=.01*o,targetCameraAngleX=Math.max(.1,Math.min(Math.PI/2-.1,targetCameraAngleX)),mouseX=t.clientX,mouseY=t.clientY}}),e.addEventListener("mouseleave",()=>{isMouseDown=!1,e.style.cursor="grab",hoveredMenuMesh&&(hoveredMenuMesh.scale.set(1,1,1),hoveredMenuMesh=null)}),e.addEventListener("wheel",e=>{e.preventDefault();targetCameraDistance=e.deltaY<0?Math.max(2,targetCameraDistance-.5):Math.min(15,targetCameraDistance+.5)}),document.addEventListener("keydown",e=>{switch(e.key){case"+":case"=":targetCameraDistance=Math.max(2,targetCameraDistance-.5);break;case"-":targetCameraDistance=Math.min(15,targetCameraDistance+.5);break;case"0":targetCameraDistance=5}}),e.style.cursor="grab",e.style.touchAction="none",isMobileScreen()&&(e.addEventListener("touchstart",e=>{if(e.preventDefault(),1===e.touches.length){isTouching=!0;const t=e.touches[0];lastTouchX=t.clientX,lastTouchY=t.clientY,touchStartX=t.clientX,touchStartY=t.clientY,touchStartAngleX=targetCameraAngleX,touchStartAngleY=targetCameraAngleY}else if(2===e.touches.length){isTouching=!0;const t=e.touches[0],o=e.touches[1];initialDistance=Math.sqrt(Math.pow(o.clientX-t.clientX,2)+Math.pow(o.clientY-t.clientY,2)),initialCameraDistance=targetCameraDistance}},{passive:!1}),e.addEventListener("touchmove",e=>{if(e.preventDefault(),isTouching&&1===e.touches.length){const t=e.touches[0],o=t.clientX-lastTouchX,s=t.clientY-lastTouchY;targetCameraAngleY-=.01*o,targetCameraAngleX+=.01*s,targetCameraAngleX=Math.max(.1,Math.min(Math.PI/2-.1,targetCameraAngleX)),lastTouchX=t.clientX,lastTouchY=t.clientY}else if(isTouching&&2===e.touches.length){const t=e.touches[0],o=e.touches[1],s=Math.sqrt(Math.pow(o.clientX-t.clientX,2)+Math.pow(o.clientY-t.clientY,2));if(initialDistance>0){const e=s/initialDistance;targetCameraDistance=Math.max(2,Math.min(15,initialCameraDistance/e))}}},{passive:!1}),e.addEventListener("touchend",e=>{if(e.preventDefault(),0===e.touches.length&&1===e.changedTouches.length){if(isTouching=!1,initialDistance=0,initialCameraDistance=0,mobileMenuGroup&&mobileMenuGroup.visible){const t=e.changedTouches[0],o=new THREE.Vector2;o.x=t.clientX/window.innerWidth*2-1,o.y=-t.clientY/window.innerHeight*2+1;const s=new THREE.Raycaster;s.setFromCamera(o,camera);const n=s.intersectObjects(mobileMenuButtons,!0);n.length>0&&handle3DMenuClick(n[0].object)}}else if(1===e.touches.length){const t=e.touches[0];lastTouchX=t.clientX,lastTouchY=t.clientY,touchStartX=t.clientX,touchStartY=t.clientY,touchStartAngleX=targetCameraAngleX,touchStartAngleY=targetCameraAngleY}},{passive:!1}),e.addEventListener("touchcancel",e=>{e.preventDefault(),isTouching=!1,initialDistance=0,initialCameraDistance=0},{passive:!1}))}function createBasicRoom(){console.log("Creating basic 3D room structure..."),room=new THREE.Group,createWalls(),createWindow(),createSunlightBeams(),createMirrorReflection(),scene.add(room),console.log("Basic 3D room created successfully!")}function createMobile3DMenu(){mobileMenuGroup&&scene.remove(mobileMenuGroup),mobileMenuGroup=new THREE.Group,mobileMenuGroup.name="mobile3DMenu";mobileMenuButtons=[],mobileMenuGroup.visible=!0,scene.add(mobileMenuGroup),createMenuTextOverlays([{name:"title",position:{x:7.75,y:5,z:-5},text:"sabrina do",isTitle:!0},{name:"about",position:{x:7.5,y:4.25,z:-5},text:"about me"},{name:"projects",position:{x:7.5,y:3.5,z:-5},text:"projects"},{name:"experience",position:{x:7.5,y:2.75,z:-5},text:"work experience"},{name:"education",position:{x:7.5,y:2,z:-5},text:"education"},{name:"contact",position:{x:7.5,y:1.25,z:-5},text:"contact me"}]),createMenuReflection(),console.log("3D Mobile menu created successfully!")}function createMenuTextOverlays(e){document.querySelectorAll(".menu-text-overlay").forEach(e=>e.remove()),e.forEach((e,t)=>{const o=document.createElement("canvas"),s=o.getContext("2d");o.width=2048,o.height=512,s.imageSmoothingEnabled=!0,s.imageSmoothingQuality="high",s.fillStyle="transparent",s.fillRect(0,0,o.width,o.height);const n=isMobileScreen(),i=n?1.2:1,a=n?1.5:1;e.isTitle?(s.fillStyle="#2E2019",s.font=`bold ${Math.floor(260*i)}px 'Comic Sans MS', cursive, sans-serif`,s.textAlign="left",s.textBaseline="middle",s.lineWidth=32*a,s.strokeStyle="#ffb6c1",s.strokeText(e.text.toLowerCase(),80,o.height/2),s.lineWidth=24*a,s.strokeStyle="#ffc0cb",s.strokeText(e.text.toLowerCase(),80,o.height/2),s.lineWidth=16*a,s.strokeStyle="#ffffff",s.strokeText(e.text.toLowerCase(),80,o.height/2),n&&(s.shadowColor="rgba(0, 0, 0, 0.8)",s.shadowBlur=20,s.shadowOffsetX=4,s.shadowOffsetY=4),s.fillText(e.text.toLowerCase(),80,o.height/2),n&&(s.shadowColor="transparent",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0)):(s.fillStyle="#2E2019",s.font=`bold ${Math.floor(240*i)}px 'Comic Sans MS', cursive, sans-serif`,s.textAlign="left",s.textBaseline="middle",n&&(s.lineWidth=8*a,s.strokeStyle="#ffffff",s.strokeText(e.text.toLowerCase(),80,o.height/2)),n&&(s.shadowColor="rgba(0, 0, 0, 0.6)",s.shadowBlur=15,s.shadowOffsetX=3,s.shadowOffsetY=3),s.fillText(e.text.toLowerCase(),80,o.height/2),n&&(s.shadowColor="transparent",s.shadowBlur=0,s.shadowOffsetX=0,s.shadowOffsetY=0));const r=new THREE.CanvasTexture(o);r.needsUpdate=!0;const l=n?1.2:1,c=e.isTitle?new THREE.PlaneGeometry(5.5*l,1.6*l):new THREE.PlaneGeometry(4.5*l,1.2*l),d=new THREE.MeshBasicMaterial({map:r,transparent:!0,opacity:1,side:THREE.DoubleSide,alphaTest:.1,depthWrite:!1}),u=new THREE.Mesh(c,d);u.position.set(e.position.x,e.position.y,e.position.z),u.rotation.y=0,mobileMenuGroup.add(u),e.isTitle?u.userData={type:"title",sectionId:"title",index:t}:(u.userData={type:"menuButton",sectionId:e.name,index:t},mobileMenuButtons.push(u))})}function createMenuReflection(){if(!mobileMenuGroup)return;const e=mobileMenuGroup.clone();e.scale.y=-1,e.position.y=-5.5,e.traverse(e=>{if(e.isMesh&&e.material){const t=e.material.clone();t.transparent=!0,t.opacity=.25,t.depthWrite=!1,t.color&&(t.color.multiplyScalar(.4),t.color.r*=.8,t.color.g*=.9,t.color.b*=1.1),e.material=t}}),scene.add(e)}function toggleMobile3DMenu(){if(!mobileMenuGroup)return;isMobile3DMenuActive=!isMobile3DMenuActive,mobileMenuGroup.visible=isMobile3DMenuActive;const e=document.getElementById("navigation-modal");e&&(e.style.display="none"),console.log("3D Mobile menu toggled:",isMobile3DMenuActive)}function handle3DMenuClick(e){if(!e||!e.userData||"menuButton"!==e.userData.type)return;const t=e.userData.sectionId;console.log("3D Menu button clicked:",t),toggleMobile3DMenu(),showContentSection(t);const o=e.scale.clone();e.scale.multiplyScalar(1.1),setTimeout(()=>{e.scale.copy(o)},200)}function addMobileMenuToggle(){const e=document.getElementById("mobile-menu-toggle");e&&e.remove();const t=document.createElement("button");t.id="mobile-menu-toggle",t.innerHTML="â˜°",t.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    width: 50px;\n    height: 50px;\n    border-radius: 50%;\n    background: rgba(255, 182, 193, 0.9);\n    border: 2px solid #8b4513;\n    color: #8b4513;\n    font-size: 20px;\n    font-weight: bold;\n    cursor: pointer;\n    z-index: 10000;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    backdrop-filter: blur(10px);\n    transition: all 0.3s ease;\n  ",t.addEventListener("mouseenter",()=>{t.style.background="rgba(255, 192, 203, 0.95)",t.style.transform="scale(1.05)"}),t.addEventListener("mouseleave",()=>{t.style.background="rgba(255, 182, 193, 0.9)",t.style.transform="scale(1)"}),t.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),toggleMobile3DMenu()}),document.body.appendChild(t),console.log("Mobile menu toggle button added")}function prepareAsset(e){if(!e||!e.clone)return null;const t=e.clone();return t.traverse&&t.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.material&&(Array.isArray(e.material)?e.material.forEach(e=>{e&&(e.needsUpdate=!0)}):e.material.needsUpdate=!0))}),t}function createMirrorReflection(){const e=room.clone();e.scale.y=-1,e.position.y=-5.5,e.traverse(e=>{if(e.userData&&e.userData.isGlowMesh)e.visible=!1;else if(e.isMesh&&e.material)if(Array.isArray(e.material))e.material.forEach(t=>{const o=t.clone();o.transparent=!0,o.opacity=.25,o.depthWrite=!1,o.color&&(o.color.multiplyScalar(.4),o.color.r*=.8,o.color.g*=.9,o.color.b*=1.1),e.material=o});else{const t=e.material.clone();t.transparent=!0,t.opacity=.25,t.depthWrite=!1,t.color&&(t.color.multiplyScalar(.4),t.color.r*=.8,t.color.g*=.9,t.color.b*=1.1),e.material=t}}),scene.add(e),window.mirroredRoom=e,console.log("Room reflection created successfully (glow meshes excluded)!")}function addAssetToMirror(e){if(!window.mirroredRoom)return void console.warn("Mirrored room not found, cannot add asset to mirror");const t=e.clone();t.scale.y=e.scale.y,t.scale.x=e.scale.x,t.scale.z=e.scale.z,t.position.y=-1+e.position.y,t.traverse(e=>{if(e.userData&&e.userData.isGlowMesh)e.visible=!1;else if(e.isMesh&&e.material)if(Array.isArray(e.material))e.material.forEach(t=>{const o=t.clone();o.transparent=!0,o.opacity=.25,o.depthWrite=!1,o.color&&(o.color.multiplyScalar(.4),o.color.r*=.8,o.color.g*=.9,o.color.b*=1.1),e.material=o});else{const t=e.material.clone();t.transparent=!0,t.opacity=.25,t.depthWrite=!1,t.color&&(t.color.multiplyScalar(.4),t.color.r*=.8,t.color.g*=.9,t.color.b*=1.1),e.material=t}}),window.mirroredRoom.add(t),console.log(`Added ${e.name} to mirror at position (${t.position.x}, ${t.position.y}, ${t.position.z})`)}function createShelves(){const e=new THREE.MeshLambertMaterial({color:16777215}),t=new THREE.BoxGeometry(3,.1,1),o=new THREE.Mesh(t,e);o.position.set(2.5,1.5,-4.5),o.castShadow=!0,room.add(o),createPlant(1.5,1.6,-4.5)}function createWoodPlanksTexture({planks:e=6,baseColor:t="#c9916a",variation:o=12,seamColor:s="#7b4f34"}={}){const n=512,i=document.createElement("canvas");i.width=n,i.height=n;const a=i.getContext("2d"),r=(e,t,o)=>Math.max(t,Math.min(o,e));const l=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:201,g:145,b:106}}(t),c=n/e;for(let t=0;t<e;t++){const e=(2*Math.random()-1)*o,i=r(l.r+e,0,255),d=r(l.g+.7*e,0,255),u=r(l.b+.4*e,0,255);a.fillStyle=`rgb(${i},${d},${u})`,a.fillRect(0,t*c,n,c),a.globalAlpha=.08,a.strokeStyle="#000";for(let e=0;e<n;e+=6+10*Math.random()){const o=t*c+Math.random()*c;a.beginPath(),a.moveTo(e,o),a.lineTo(e+30+40*Math.random(),o+6*(Math.random()-.5)),a.stroke()}a.globalAlpha=1,t>0&&(a.fillStyle=s,a.fillRect(0,t*c-2,n,2))}a.fillStyle=s;for(let e=0;e<n;e+=128)a.fillRect(e,0,1,n);const d=new THREE.CanvasTexture(i);return d.wrapS=THREE.RepeatWrapping,d.wrapT=THREE.RepeatWrapping,d.anisotropy=4,d}function createWalls(){const e=new THREE.MeshLambertMaterial({color:15517871}),t=new THREE.MeshLambertMaterial({color:15517871}),o=(new THREE.MeshLambertMaterial({color:16748964}),new THREE.BoxGeometry(10,.5,10)),s=createWoodPlanksTexture({planks:8,baseColor:"#c48a5a",variation:18,seamColor:"#8b5a3c"});s.repeat.set(2,3);const n=new THREE.MeshLambertMaterial({map:s,color:10120006}),i=new THREE.Mesh(o,n);i.position.y=-2.25,i.receiveShadow=!0,i.castShadow=!0,room.add(i);const a=new THREE.BoxGeometry(10.5,.3,10.2),r=new THREE.MeshLambertMaterial({color:2430210}),l=new THREE.Mesh(a,r);l.position.y=-2.6,l.receiveShadow=!0,l.castShadow=!0,room.add(l);const c=new THREE.BoxGeometry(10.4,8.4,.3),d=new THREE.Mesh(c,e);d.position.z=-5.15,d.position.x=-.1,d.position.y=1.5,d.castShadow=!0,d.receiveShadow=!0,room.add(d);const u=new THREE.BoxGeometry(.3,2.2,10),h=new THREE.Mesh(u,t);h.position.x=-5.15,h.position.y=4.4,h.castShadow=!0,h.receiveShadow=!0,room.add(h);const m=new THREE.BoxGeometry(.3,3.5,10),p=new THREE.Mesh(m,t);p.position.x=-5.15,p.position.y=-1,p.castShadow=!0,p.receiveShadow=!0,room.add(p);const g=new THREE.BoxGeometry(.3,3,2.9),y=new THREE.Mesh(g,t);y.position.x=-5.15,y.position.y=2,y.position.z=-3.55,y.castShadow=!0,y.receiveShadow=!0,room.add(y);const f=new THREE.BoxGeometry(.3,3,6),w=new THREE.Mesh(f,t);w.position.x=-5.15,w.position.y=2,w.position.z=2,w.castShadow=!0,w.receiveShadow=!0,room.add(w);const b=new THREE.BoxGeometry(10.55,.3,.6),E=new THREE.MeshLambertMaterial({color:6111778}),v=new THREE.Mesh(b,E);v.position.z=-5.1,v.position.x=-.12,v.position.y=5.65,v.castShadow=!0,v.receiveShadow=!0,room.add(v);const M=new THREE.BoxGeometry(.6,.3,10),T=new THREE.MeshLambertMaterial({color:6111778}),S=new THREE.Mesh(M,T);S.position.x=-5.1,S.position.y=5.65,S.castShadow=!0,S.receiveShadow=!0,room.add(S)}function createFloorTrim(){}function createRoomDecorations(){}function createPlant(e,t,o,s=3046706){const n=new THREE.Group,i=new THREE.CylinderGeometry(.15,.15,.2,8),a=new THREE.MeshLambertMaterial({color:16761035}),r=new THREE.Mesh(i,a);r.position.set(0,0,0),r.castShadow=!0,n.add(r);const l=new THREE.SphereGeometry(.2,8,6),c=new THREE.MeshLambertMaterial({color:s}),d=new THREE.Mesh(l,c);d.position.set(0,.2,0),d.scale.set(1,1.5,1),d.castShadow=!0,n.add(d);for(let e=0;e<3;e++){const e=new THREE.SphereGeometry(.03,4,4),t=new THREE.MeshLambertMaterial({color:16738740}),o=new THREE.Mesh(e,t);o.position.set(.3*(Math.random()-.5),.3+.1*Math.random(),.3*(Math.random()-.5)),o.castShadow=!0,n.add(o)}n.position.set(e,t,o),room.add(n)}function setupBloomEffect(){}function addGlowEffectToBooks(e){e.userData={glowProcessed:!0,glowMeshes:[]},e.traverse(t=>{if(t.isMesh&&t.material&&!t.userData.glowProcessed&&!t.userData.isGlowMesh){t.userData={glowProcessed:!0};[{scale:1.01,opacity:.04,color:16301017,blending:THREE.AdditiveBlending},{scale:1.03,opacity:.025,color:15771848,blending:THREE.AdditiveBlending},{scale:1.05,opacity:.015,color:15243448,blending:THREE.AdditiveBlending}].forEach((o,s)=>{const n=new THREE.MeshBasicMaterial({color:o.color,transparent:!0,opacity:o.opacity,side:THREE.BackSide,blending:o.blending,depthWrite:!1,depthTest:!1}),i=new THREE.Mesh(t.geometry,n);i.scale.set(o.scale,o.scale,o.scale);const a=.001*(s+1);i.position.set(t.position.x+(Math.random()-.5)*a,t.position.y+(Math.random()-.5)*a,t.position.z+(Math.random()-.5)*a),i.rotation.copy(t.rotation),i.userData={isGlowMesh:!0,layerIndex:s,originalOpacity:o.opacity},t.add(i),e.userData.glowMeshes.push(i)})}}),window.glowingBooks||(window.glowingBooks=[]),window.glowingBooks.push(e)}function addCakeGlowEffect(e){e.userData={glowProcessed:!0,glowMeshes:[]},e.traverse(t=>{if(t.isMesh&&t.material&&!t.userData.glowProcessed&&!t.userData.isGlowMesh){t.userData={glowProcessed:!0};[{scale:1.01,opacity:.02,color:16301017,blending:THREE.AdditiveBlending},{scale:1.02,opacity:.01,color:15771848,blending:THREE.AdditiveBlending}].forEach((o,s)=>{const n=new THREE.MeshBasicMaterial({color:o.color,transparent:!0,opacity:o.opacity,side:THREE.BackSide,blending:o.blending,depthWrite:!1,depthTest:!1}),i=new THREE.Mesh(t.geometry,n);i.scale.set(o.scale,o.scale,o.scale);const a=5e-4*(s+1);i.position.set(t.position.x+(Math.random()-.5)*a,t.position.y+(Math.random()-.5)*a,t.position.z+(Math.random()-.5)*a),i.rotation.copy(t.rotation),i.userData={isGlowMesh:!0,layerIndex:s,originalOpacity:o.opacity},t.add(i),e.userData.glowMeshes.push(i)})}}),window.glowingBooks||(window.glowingBooks=[]),window.glowingBooks.push(e)}function setGlowVisibility(e){window.glowingBooks&&window.glowingBooks.forEach(t=>{t.userData&&t.userData.glowMeshes&&t.userData.glowMeshes.forEach(t=>{animateGlowOpacity(t,e?t.userData.originalOpacity:0)})})}function animateGlowOpacity(e,t,o=300){if(!e.material)return;e.userData.animationId&&cancelAnimationFrame(e.userData.animationId);const s=e.material.opacity,n=Date.now();!function i(){const a=Date.now()-n,r=Math.min(a/o,1),l=r<.5?4*r*r*r:1-Math.pow(-2*r+2,3)/2,c=s+(t-s)*l;e.material.opacity=c,e.visible=!0,r<1?e.userData.animationId=requestAnimationFrame(i):(e.userData.animationId=null,0===t&&(e.visible=!1))}()}function animateGlowingBooks(){window.glowingBooks&&window.glowingBooks.forEach(e=>{})}function animateSunlightBeams(){window.sunlightBeams&&window.sunlightBeams.forEach(e=>{e.children.forEach(e=>{if(e.userData&&e.material){const t=.001*Date.now(),o=.3*Math.sin(t*e.userData.animationSpeed+e.userData.animationOffset)+.7;e.material.opacity=e.userData.originalOpacity*o}})})}function createWindow(){const e=new THREE.PlaneGeometry(1.2,3),t=new THREE.MeshLambertMaterial({color:8900331,transparent:!0,opacity:.85,side:THREE.DoubleSide}),o=new THREE.Mesh(e,t);o.position.set(-5.15,2,-1.5),o.rotation.y=Math.PI/2,room.add(o)}function createSunlightBeams(){const e=new THREE.Group;e.name="sunlightBeams";for(let t=0;t<4;t++){const o=2.5*(.7+.6*Math.random()),s=new THREE.BoxGeometry(.03,.05,o),n=new THREE.MeshBasicMaterial({color:16775408,transparent:!0,opacity:.1+.15*Math.random(),side:THREE.DoubleSide,blending:THREE.NormalBlending,depthWrite:!1}),i=new THREE.Mesh(s,n),a=1.2*(Math.random()-.5)*.6,r=3*(Math.random()-.5)*.4;i.position.set(-4.15,2+r,-1.5+a+.25);const l=-300,c=-20,d=-25-i.position.x,u=l-i.position.y,h=c-i.position.z,m=Math.atan2(d,h)+.15,p=-Math.atan2(u,Math.sqrt(d*d+h*h))-Math.PI/5+.2*(Math.random()-.5);i.rotation.set(p,m,0),i.scale.set(1,1,1),i.userData={originalOpacity:n.opacity,animationOffset:t/4*Math.PI*2,animationSpeed:.3},e.add(i)}room.add(e),window.sunlightBeams||(window.sunlightBeams=[]),window.sunlightBeams.push(e),console.log("Streamlined sunlight beams created successfully!")}function animate(){animationId=requestAnimationFrame(animate),cameraAngleX+=.1*(targetCameraAngleX-cameraAngleX),cameraAngleY+=.1*(targetCameraAngleY-cameraAngleY),cameraDistance+=.1*(targetCameraDistance-cameraDistance),updateCameraPosition(),animateGlowingBooks(),animateSunlightBeams(),mobileMenuGroup&&(mobileMenuGroup.visible=!0),renderer&&scene&&camera?renderer.render(scene,camera):console.error("Renderer, scene, or camera not initialized!")}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight),composer&&composer.setSize(window.innerWidth,window.innerHeight);const e=document.getElementById("navigation-modal");document.getElementById("mobile-menu-toggle");e&&(e.style.display="none"),mobileMenuGroup||createMobile3DMenu()}function initModal(){const e=document.getElementById("navigation-modal"),t=document.querySelectorAll(".nav-link"),o=(document.querySelectorAll(".content-section"),document.getElementById("close-modal"));createMobile3DMenu(),e&&(e.addEventListener("mouseenter",()=>{setGlowVisibility(!1)}),e.addEventListener("mouseleave",()=>{setGlowVisibility(!0)})),t.forEach(e=>{e.addEventListener("mouseenter",()=>{setGlowVisibility(!1)}),e.addEventListener("mouseleave",()=>{setGlowVisibility(!0)})}),e&&(e.style.display="none"),t.forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();showContentSection(e.getAttribute("href").substring(1))})}),o&&o.addEventListener("click",()=>{hideAllContentSections()}),e&&e.addEventListener("click",t=>{t.target===e&&hideAllContentSections()});const s=document.querySelector(".scrapbook-modal");s&&s.addEventListener("click",e=>{e.target===s&&setTimeout(()=>{hideAllContentSections()},100)});const n=document.querySelector(".desktop-modal");n&&n.addEventListener("click",e=>{(e.target===n||e.target.classList.contains("close-instruction"))&&hideAllContentSections()}),initProjectFolders();const i=document.querySelector(".resume-preview-modal");i&&i.addEventListener("click",e=>{(e.target===i||e.target.classList.contains("close-instruction"))&&hideAllContentSections()});const a=document.querySelector(".education-modal");a&&a.addEventListener("click",e=>{(e.target===a||e.target.classList.contains("close-instruction"))&&hideAllContentSections()});const r=document.querySelector(".contact-modal");r&&r.addEventListener("click",e=>{(e.target===r||e.target.classList.contains("close-instruction"))&&hideAllContentSections()}),document.addEventListener("click",e=>{const t=document.querySelector(".content-section.active");if(t){const o=t.querySelector(".scrapbook-content, .desktop-window, .resume-preview-content, .education-content, .contact-content");!o||o.contains(e.target)||e.target.closest(".nav-link")||hideAllContentSections()}})}function showContentSection(e){hideAllContentSections(),hideMusicPlayer(),preventBodyScroll(),mobileMenuGroup&&(mobileMenuGroup.visible=!0),setTimeout(()=>{const t=document.getElementById(e);t&&(t.classList.add("active"),"experience"===e&&console.log("Experience section opened - music player should be hidden")),mobileMenuGroup&&(mobileMenuGroup.visible=!0)},50)}function hideAllContentSections(){document.querySelectorAll(".content-section").forEach(e=>{if(e.classList.contains("active")){const t=e.querySelector(".scrapbook-content, .desktop-window, .briefcase-container, .education-content, .contact-content");t&&(t.style.animation="modalFadeOut 0.3s cubic-bezier(0.4, 0, 0.2, 1)"),e.classList.remove("active"),e.style.display="none",t?setTimeout(()=>{t.style.animation="",e.style.display=""},300):e.style.display="",showMusicPlayer(),enableBodyScroll()}})}function preventBodyScroll(){document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${window.scrollY}px`}function enableBodyScroll(){const e=document.body.style.top;document.body.style.overflow="",document.body.style.position="",document.body.style.width="",document.body.style.top="",e&&window.scrollTo(0,-1*parseInt(e||"0"))}function hideMusicPlayer(){const e=document.querySelector(".music-player");e&&(e.style.display="none")}function showMusicPlayer(){const e=document.querySelector(".music-player");e&&(e.style.display="block")}function initAudioPlayer(){const e=document.getElementById("play-pause"),t=(document.getElementById("progress"),document.getElementById("current-time"),document.getElementById("duration"),document.getElementById("volume"));let o=!1;e.addEventListener("click",()=>{o=!o;e.querySelector("i").className=o?"fas fa-pause":"fas fa-play"}),t.addEventListener("input",e=>{console.log("Volume:",e.target.value)})}function waitForThreeJS(){"undefined"!=typeof THREE?(console.log("Three.js loaded successfully!"),init3D()):(console.log("Waiting for Three.js to load..."),setTimeout(waitForThreeJS,100))}document.addEventListener("DOMContentLoaded",()=>{console.log("DOM loaded, initializing..."),document.body.classList.add("loading"),preventBodyScroll(),waitForThreeJS(),initModal(),initAudioPlayer(),initMusicPlayer(),window.addEventListener("resize",onWindowResize)});class SpotifyMusicPlayer{constructor(){this.clientId="b3629d1eb6a34dbd91aed2ef24c497f1",this.redirectUri=window.location.origin+"/",this.accessToken=null,this.currentTrack=null,this.audio=null,this.isPlaying=!1,this.isExpanded=!1,this.isLoggedIn=!1,this.defaultTrackId="5VBjyOQzqlPNgdRPMM6prF",this.defaultAudioUrl="https://p.scdn.co/mp3-preview/5VBjyOQzqlPNgdRPMM6prF?cid=b3629d1eb6a34dbd91aed2ef24c497f1",this.searchWhitelist=["sabpdo@mit.edu","norapan99@hotmail.com","sabpdo@icloud.com"],this.userEmail=null,this.hasSearchAccess=!1,this.restrictedInterfaceShown=!1,this.embedHidingInterval=null,this.initializeElements(),this.setupEventListeners(),this.initializeDefaultMusic(),this.setupResponsiveHandling()}initializeElements(){this.musicToggle=document.getElementById("music-toggle"),this.musicContent=document.getElementById("music-content"),console.log("Music toggle found:",this.musicToggle),console.log("Music content found:",this.musicContent),this.musicTitle=document.querySelector(".music-title"),this.spotifyLogin=document.getElementById("spotify-login"),this.musicPlayerContent=document.getElementById("music-player-content"),this.spotifyLoginBtn=document.getElementById("spotify-login-btn"),this.searchInput=document.getElementById("search-input"),this.searchBtn=document.getElementById("search-btn"),this.searchResults=document.getElementById("search-results"),this.resultsList=document.getElementById("results-list"),this.trackTitle=document.getElementById("track-title"),this.trackArtist=document.getElementById("track-artist"),this.albumArt=document.getElementById("album-art"),this.playPauseBtn=document.getElementById("play-pause"),this.rewindBtn=document.getElementById("rewind"),this.forwardBtn=document.getElementById("forward"),this.volumeSlider=document.getElementById("volume"),this.progressBar=document.getElementById("progress"),this.currentTimeSpan=document.getElementById("current-time"),this.durationSpan=document.getElementById("duration")}setupEventListeners(){this.musicToggle.addEventListener("click",e=>{console.log("Music toggle clicked!"),e.stopPropagation(),this.toggleExpanded()}),this.musicContent.addEventListener("wheel",e=>{e.preventDefault(),e.stopPropagation()},{passive:!1}),this.musicContent.addEventListener("touchmove",e=>{e.preventDefault(),e.stopPropagation()},{passive:!1}),this.musicContent.addEventListener("scroll",e=>{e.preventDefault(),e.stopPropagation()},{passive:!1}),this.musicTitle.addEventListener("click",e=>{console.log("Now Playing clicked!"),e.stopPropagation(),this.toggleExpanded()}),this.musicTitle.style.cursor="pointer",this.musicTitle.style.userSelect="none",this.spotifyLoginBtn.addEventListener("click",()=>{this.loginToSpotify()}),this.searchBtn.addEventListener("click",()=>{this.searchTracks()}),this.searchInput.addEventListener("keypress",e=>{"Enter"===e.key&&this.searchTracks()}),this.playPauseBtn.addEventListener("click",()=>{this.togglePlayPause()}),this.rewindBtn.addEventListener("click",()=>{this.previousTrack()}),this.forwardBtn.addEventListener("click",()=>{this.nextTrack()}),this.volumeSlider.addEventListener("input",e=>{this.setVolume(e.target.value)}),this.progressBar.addEventListener("click",e=>{this.seekTo(e)}),this.checkForAccessToken()}toggleExpanded(){console.log("Toggle expanded called, current state:",this.isExpanded),console.log("Music content element:",this.musicContent),this.isExpanded=!this.isExpanded,this.isExpanded?(this.musicContent.classList.add("show"),this.musicToggle.innerHTML='<i class="fas fa-chevron-up"></i>',console.log("Music player expanded"),this.showDefaultEmbed()):(this.musicContent.classList.remove("show"),this.musicToggle.innerHTML='<i class="fas fa-music"></i>',console.log("Music player collapsed"))}initializeDefaultMusic(){window.innerWidth<=768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?(this.isExpanded=!1,this.musicContent.classList.remove("show"),this.musicToggle.innerHTML='<i class="fas fa-music"></i>'):(this.isExpanded=!0,this.musicContent.classList.add("show"),this.musicToggle.innerHTML='<i class="fas fa-chevron-up"></i>'),this.createDefaultEmbed(),this.isExpanded&&this.showDefaultEmbed()}playDefaultTrack(){this.trackTitle.textContent="seasons",this.trackArtist.textContent="wave to earth",this.updateHeaderNowPlaying("seasons"),this.showDefaultEmbed()}createDefaultEmbed(){if(this.restrictedInterfaceShown)return void console.log("Skipping createDefaultEmbed for restricted user");let e=document.getElementById("spotify-default-embed");e||(e=document.createElement("iframe"),e.id="spotify-default-embed",e.setAttribute("data-testid","embed-iframe"),e.style.borderRadius="12px",e.height="152",e.frameBorder="0",e.allowFullscreen=!0,e.allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",e.loading="lazy",this.musicContent.appendChild(e)),this.setEmbedResponsiveWidth(e),e.src=`https://open.spotify.com/embed/track/${this.defaultTrackId}?utm_source=generator`}showDefaultEmbed(){this.restrictedInterfaceShown?console.log("Skipping showDefaultEmbed for restricted user"):this.isExpanded?(this.createDefaultEmbed(),this.musicPlayerContent.style.display="none",this.spotifyLogin.style.display="none",this.createCompactLoginButton()):console.log("Music player is closed, not showing embed")}createCompactLoginButton(){const e=document.getElementById("compact-login-btn");e&&e.remove();const t=document.createElement("button");t.id="compact-login-btn",t.innerHTML='<i class="fab fa-spotify"></i> Login to Spotify',t.style.background="rgba(255, 255, 255, 0.9)",t.style.color="#ff69b4",t.style.border="none",t.style.borderRadius="20px",t.style.padding="8px 16px",t.style.fontWeight="600",t.style.fontSize="13px",t.style.cursor="pointer",t.style.transition="all 0.3s ease",t.style.boxShadow="0 2px 8px rgba(255, 105, 180, 0.2)",t.style.margin="10px auto",t.style.display="block",t.addEventListener("mouseenter",()=>{t.style.background="white",t.style.color="#ff1493",t.style.transform="translateY(-2px)",t.style.boxShadow="0 4px 12px rgba(255, 105, 180, 0.3)"}),t.addEventListener("mouseleave",()=>{t.style.background="rgba(255, 255, 255, 0.9)",t.style.color="#ff69b4",t.style.transform="translateY(0)",t.style.boxShadow="0 2px 8px rgba(255, 105, 180, 0.2)"}),t.addEventListener("click",()=>{this.loginToSpotify()});const o=document.getElementById("spotify-default-embed");o&&o.parentNode&&o.parentNode.insertBefore(t,o.nextSibling)}setEmbedResponsiveWidth(e){window.innerWidth;window.innerWidth<=480?(e.width="100%",e.style.width="100%",e.style.maxWidth="100%",e.height="140"):(e.width="100%",e.style.width="100%",e.style.maxWidth="100%")}setupResponsiveHandling(){window.addEventListener("resize",()=>{const e=window.innerWidth<=768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t=window.innerWidth<1024,o=document.getElementById("spotify-default-embed");o&&this.setEmbedResponsiveWidth(o);const s=document.getElementById("spotify-embed");s&&this.setEmbedResponsiveWidth(s),(e||t)&&this.isExpanded&&this.toggleExpanded()})}async loginToSpotify(){const e=this.generateCodeVerifier(),t=await this.generateCodeChallenge(e);sessionStorage.setItem("spotify_code_verifier",e);const o=new URLSearchParams({client_id:this.clientId,response_type:"code",redirect_uri:this.redirectUri,scope:"user-read-private user-read-email user-top-read user-read-recently-played",code_challenge_method:"S256",code_challenge:t});window.location.href=`https://accounts.spotify.com/authorize?${o.toString()}`}async checkForAccessToken(){const e=new URLSearchParams(window.location.search).get("code");if(e)try{return await this.exchangeCodeForToken(e),void window.history.replaceState({},document.title,window.location.pathname)}catch(e){console.error("PKCE token exchange failed:",e)}const t=window.location.hash,o=new URLSearchParams(t.substring(1)).get("access_token");o?(this.accessToken=o,await this.getUserEmail(),this.showMusicPlayer(),window.history.replaceState({},document.title,window.location.pathname)):this.showLoginInterface()}showLoginInterface(){this.isLoggedIn=!1,this.spotifyLogin.style.display="block",this.musicPlayerContent.style.display="none",this.spotifyLogin.style.padding="",this.spotifyLogin.style.textAlign="",this.spotifyLogin.style.background="",this.spotifyLogin.style.borderRadius="",this.spotifyLogin.style.marginTop="",this.spotifyLogin.style.border="",this.spotifyLogin.style.boxShadow="";const e=this.spotifyLogin.querySelector("button");e&&(e.style.background="#ff69b4",e.style.color="white",e.style.border="none",e.style.borderRadius="25px",e.style.padding="12px 24px",e.style.fontWeight="600",e.style.fontSize="14px",e.style.cursor="pointer",e.style.transition="all 0.3s ease",e.style.boxShadow="0 2px 8px rgba(255, 105, 180, 0.3)",e.style.margin="10px auto",e.style.display="block"),this.showDefaultEmbed()}async exchangeCodeForToken(e){const t=sessionStorage.getItem("spotify_code_verifier");if(!t)throw new Error("Missing PKCE code_verifier in sessionStorage");const o=new URLSearchParams({client_id:this.clientId,grant_type:"authorization_code",code:e,redirect_uri:this.redirectUri,code_verifier:t}),s=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o.toString()}),n=await s.json();if(!s.ok)throw new Error(n.error_description||JSON.stringify(n));this.accessToken=n.access_token,await this.getUserEmail(),this.showMusicPlayer()}async getUserEmail(){try{console.log("Getting user email with token:",this.accessToken?"present":"missing");const e=await fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${this.accessToken}`}});if(console.log("User email response status:",e.status),e.ok){const t=await e.json();this.userEmail=t.email,this.hasSearchAccess=this.searchWhitelist.includes(this.userEmail),console.log("User email:",this.userEmail),console.log("Whitelist:",this.searchWhitelist),console.log("Has search access:",this.hasSearchAccess)}else 403===e.status?(console.log("403 Forbidden - Email access not available, defaulting to restricted access"),this.userEmail=null,this.hasSearchAccess=!1,this.forceShowRestrictedInterface()):(console.error("Failed to get user email, status:",e.status),this.userEmail=null,this.hasSearchAccess=!1,console.log("Cannot verify user email - denying search access for security"))}catch(e){console.error("Error getting user email:",e),this.userEmail=null,this.hasSearchAccess=!1,console.log("Error fetching user email - denying search access for security")}}generateCodeVerifier(){const e=new Uint8Array(32);return window.crypto.getRandomValues(e),btoa(String.fromCharCode.apply(null,Array.from(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async generateCodeChallenge(e){const t=(new TextEncoder).encode(e),o=await window.crypto.subtle.digest("SHA-256",t),s=new Uint8Array(o);let n="";for(let e=0;e<s.byteLength;e++)n+=String.fromCharCode(s[e]);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}showMusicPlayer(){this.isLoggedIn=!0,this.spotifyLogin.style.display="none",this.musicPlayerContent.style.display="block",this.toggleSearchVisibility(),this.updateHeaderNowPlaying(),this.hasSearchAccess&&!this.currentTrack&&this.accessToken&&this.defaultTrackId&&this.playTrack(this.defaultTrackId)}toggleSearchVisibility(){if(console.log("toggleSearchVisibility called - hasSearchAccess:",this.hasSearchAccess),console.log("User email:",this.userEmail),console.log("Restricted interface shown:",this.restrictedInterfaceShown),this.restrictedInterfaceShown)return void console.log("Restricted interface already shown, skipping toggle");const e=document.querySelector(".search-container"),t=document.getElementById("search-results");this.hasSearchAccess?(console.log("Showing full access interface"),e&&(e.style.display="flex",e.style.visibility="visible"),t&&(t.style.display="none"),this.toggleCustomPlayerVisibility(!0),this.removeLogoutButton(),this.removeDefaultEmbed()):(console.log("Showing restricted access interface"),e&&(e.style.display="none"),t&&(t.style.display="block",t.innerHTML='\n          <div class="whitelist-message">\n            <i class="fas fa-lock"></i>\n            <h4>Search Access Restricted</h4>\n            <p>Search functionality is currently limited to whitelisted users.</p>\n            <p>Contact <a href="mailto:sabpdo@mit.edu">sabpdo@mit.edu</a> for access.</p>\n            <button class="logout-btn" onclick="musicPlayer.logout()">\n              <i class="fas fa-sign-out-alt"></i>\n              Logout\n            </button>\n          </div>\n        '),this.toggleCustomPlayerVisibility(!1),this.hideDefaultEmbed())}removeDefaultEmbed(){const e=document.getElementById("spotify-default-embed");e&&e.parentNode&&e.parentNode.removeChild(e);const t=document.getElementById("compact-login-btn");t&&t.parentNode&&t.parentNode.removeChild(t),this.toggleCustomPlayerVisibility(!0)}logout(){this.accessToken=null,this.userEmail=null,this.hasSearchAccess=!1,this.isLoggedIn=!1,this.currentTrack=null,this.restrictedInterfaceShown=!1,this.audio&&(this.audio.pause(),this.audio=null),this.embedHidingInterval&&(clearInterval(this.embedHidingInterval),this.embedHidingInterval=null);const e=document.getElementById("search-results");e&&(e.style.display="none",e.innerHTML=""),document.body.style.overflow="",document.documentElement.style.overflow="",document.body.classList.remove("restricted-scroll-lock"),document.documentElement.classList.remove("restricted-scroll-lock"),this.showLoginInterface(),sessionStorage.removeItem("spotify_code_verifier"),console.log("User logged out - elements restored for login")}removeLogoutButton(){const e=document.querySelector(".logout-btn");e&&e.parentNode&&e.parentNode.removeChild(e)}hideDefaultEmbed(){const e=document.getElementById("spotify-default-embed");e&&(e.style.display="none !important",e.style.visibility="hidden",e.style.opacity="0",e.style.height="0",e.style.width="0",e.style.overflow="hidden",e.style.pointerEvents="none",e.setAttribute("hidden","true"),console.log("Default embed hidden for unauthorized user"));const t=document.getElementById("default-embed");t&&(t.style.display="none !important",t.style.visibility="hidden",t.style.opacity="0",t.style.height="0",t.style.width="0",t.setAttribute("hidden","true"),console.log("Old default embed hidden for unauthorized user"));document.querySelectorAll("iframe").forEach(e=>{e.src&&e.src.includes("spotify")&&(e.style.display="none !important",e.style.visibility="hidden",e.style.opacity="0",e.style.height="0",e.style.width="0",e.style.overflow="hidden",e.style.pointerEvents="none",e.setAttribute("hidden","true"),console.log("Spotify iframe hidden for unauthorized user"))});document.querySelectorAll("[class*='spotify'], [id*='spotify']").forEach(e=>{"search-results"!==e.id&&(e.style.display="none !important",e.style.visibility="hidden",e.style.opacity="0",e.style.height="0",e.style.width="0",e.style.overflow="hidden",e.style.pointerEvents="none",e.setAttribute("hidden","true"),console.log("Spotify element hidden for unauthorized user:",e.id||e.className))})}hideLoginButton(){const e=document.getElementById("compact-login-btn");e&&(e.style.display="none",console.log("Login button hidden for unauthorized user")),this.spotifyLogin&&(this.spotifyLogin.style.display="none",console.log("Main login interface hidden for unauthorized user"))}startEmbedHidingCheck(){this.embedHidingInterval&&clearInterval(this.embedHidingInterval),this.embedHidingInterval=setInterval(()=>{this.restrictedInterfaceShown?(this.hideDefaultEmbed(),this.aggressivelyRemoveSpotifyElements()):(clearInterval(this.embedHidingInterval),this.embedHidingInterval=null)},500)}aggressivelyRemoveSpotifyElements(){document.querySelectorAll("[class*='spotify'], [id*='spotify'], iframe[src*='spotify']").forEach(e=>{"search-results"!==e.id&&e.parentNode&&(e.parentNode.removeChild(e),console.log("Spotify element removed from DOM:",e.id||e.className))})}forceShowRestrictedInterface(){console.log("Force showing restricted interface for 403 error"),this.restrictedInterfaceShown=!0,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.classList.add("restricted-scroll-lock"),document.documentElement.classList.add("restricted-scroll-lock");const e=document.querySelector(".search-container");console.log("Search container found:",!!e),e&&(e.style.display="none",console.log("Search container hidden"));let t=document.getElementById("search-results");if(console.log("Search results element found:",!!t),!t){console.log("Creating search-results element");const e=document.getElementById("music-content");e&&(t=document.createElement("div"),t.id="search-results",t.style.display="block",t.style.visibility="visible",t.style.position="relative",t.style.zIndex="1000",e.appendChild(t),console.log("Search results element created and added to music content"))}t?(t.style.display="block",t.style.visibility="visible",t.style.position="relative",t.style.zIndex="1000",t.style.overflow="hidden",t.style.maxHeight="100vh",t.style.padding="20px",t.innerHTML='\n        <div class="whitelist-message" style="\n          background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);\n          padding: 20px;\n          border-radius: 12px;\n          box-shadow: 0 4px 20px rgba(0,0,0,0.1);\n          border: 1px solid #e9ecef;\n          text-align: center;\n          max-width: 350px;\n          margin: 0 auto;\n          overflow: hidden;\n          position: relative;\n        ">\n          <div style="margin-bottom: 20px;">\n            <i class="fas fa-lock" style="font-size: 48px; color: #ff69b4; margin-bottom: 16px; display: block; opacity: 0.8;"></i>\n            <h4 style="color: #2d3748; font-size: 18px; margin-bottom: 12px; font-weight: 700; letter-spacing: -0.025em;">Search Access Restricted</h4>\n            <p style="color: #4a5568; margin: 8px 0; line-height: 1.6; font-size: 14px;">Search functionality is currently limited to whitelisted users.</p>\n            <p style="color: #4a5568; margin: 8px 0; line-height: 1.6; font-size: 14px;">Contact <a href="mailto:sabpdo@mit.edu" style="color: #ff69b4; text-decoration: none; font-weight: 600; border-bottom: 1px solid transparent; transition: all 0.2s ease;" onmouseover="this.style.borderBottomColor=\'#ff69b4\'" onmouseout="this.style.borderBottomColor=\'transparent\'">sabpdo@mit.edu</a> for access.</p>\n          </div>\n          <button class="logout-btn" onclick="musicPlayer.logout()" style="\n            background: linear-gradient(135deg, #ff69b4 0%, #ff1493 100%);\n            color: white;\n            border: none;\n            border-radius: 8px;\n            padding: 12px 24px;\n            font-size: 13px;\n            font-weight: 600;\n            cursor: pointer;\n            transition: all 0.3s ease;\n            margin-top: 16px;\n            display: inline-flex;\n            align-items: center;\n            gap: 8px;\n            box-shadow: 0 2px 8px rgba(255, 105, 180, 0.3);\n            letter-spacing: 0.025em;\n          " onmouseover="this.style.transform=\'translateY(-1px)\'; this.style.boxShadow=\'0 4px 12px rgba(255, 105, 180, 0.4)\'" onmouseout="this.style.transform=\'translateY(0)\'; this.style.boxShadow=\'0 2px 8px rgba(255, 105, 180, 0.3)\'">\n            <i class="fas fa-sign-out-alt" style="font-size: 12px;"></i>\n            Logout\n          </button>\n        </div>\n      ',console.log("Restricted message HTML set with inline styles")):console.error("Could not create or find search results element!"),this.toggleCustomPlayerVisibility(!1),this.hideDefaultEmbed(),this.hideLoginButton(),this.startEmbedHidingCheck()}async searchTracks(){const e=this.searchInput.value.trim();if(e&&this.isLoggedIn&&this.accessToken)if(this.hasSearchAccess)try{const t=await fetch(`https://api.spotify.com/v1/search?q=${encodeURIComponent(e)}&type=track&limit=10`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),o=await t.json();this.displaySearchResults(o.tracks.items)}catch(e){console.error("Search error:",e)}else console.log("Search access denied for user:",this.userEmail)}displaySearchResults(e){this.resultsList.innerHTML="",this.searchResults.style.display="block",e.forEach(e=>{const t=document.createElement("div");t.className="result-item",t.innerHTML=`\n        <img src="${e.album.images[0]?.url||""}" alt="Album Art" onerror="this.style.display='none'">\n        <div class="result-info">\n          <div class="result-title">${e.name}</div>\n          <div class="result-artist">${e.artists[0].name}</div>\n        </div>\n        <button class="play-preview" onclick="musicPlayer.playTrackFromSearch('${e.id}')">\n          <i class="fas fa-play"></i>\n        </button>\n      `,this.resultsList.appendChild(t)})}async playTrack(e){if(this.isLoggedIn&&this.accessToken)try{const t=await fetch(`https://api.spotify.com/v1/tracks/${e}`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),o=await t.json();this.currentTrack=o,this.updateTrackDisplay(),o.preview_url?(this.playPreview(o.preview_url),this.removeEmbedIfAny()):this.showEmbed(o.id)}catch(e){console.error("Track fetch error:",e)}else console.log("User not logged in, cannot play track")}async playTrackFromSearch(e){if(this.isLoggedIn&&this.accessToken)try{const t=await fetch(`https://api.spotify.com/v1/tracks/${e}`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),o=await t.json();this.currentTrack=o,this.updateTrackDisplay(),o.preview_url?(this.playPreviewFromSearch(o.preview_url),this.removeEmbedIfAny()):this.showEmbed(o.id)}catch(e){console.error("Track fetch error:",e)}else console.log("User not logged in, cannot play track")}playPreview(e){this.audio&&this.audio.pause(),this.audio=new Audio(e),this.audio.volume=this.volumeSlider.value/100,this.audio.addEventListener("loadedmetadata",()=>{this.durationSpan.textContent=this.formatTime(this.audio.duration)}),this.audio.addEventListener("timeupdate",()=>{this.updateProgress()}),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'}),this.audio.play().then(()=>{this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'}).catch(e=>{console.log("Autoplay prevented:",e),this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'})}playPreviewFromSearch(e){this.audio&&this.audio.pause(),this.audio=new Audio(e),this.audio.volume=this.volumeSlider.value/100,this.audio.addEventListener("loadedmetadata",()=>{this.durationSpan.textContent=this.formatTime(this.audio.duration)}),this.audio.addEventListener("timeupdate",()=>{this.updateProgress()}),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'}),this.audio.load();(()=>{this.audio.play().then(()=>{console.log("Autoplay succeeded for search result"),this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'}).catch(e=>{console.log("Autoplay failed, trying user interaction approach:",e),this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>';const t=this.playPauseBtn,o=()=>{this.audio.play().then(()=>{this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'}),t.removeEventListener("click",o)};t.addEventListener("click",o)})})()}updateTrackDisplay(){if(!this.currentTrack)return;this.trackTitle.textContent=this.currentTrack.name,this.trackArtist.textContent=this.currentTrack.artists[0].name,this.updateHeaderNowPlaying(this.currentTrack.name);const e=this.albumArt.querySelector("img");e?e.src=this.currentTrack.album.images[0]?.url||"":this.albumArt.innerHTML=`<img src="${this.currentTrack.album.images[0]?.url||""}" alt="Album Art" onerror="this.innerHTML='ðŸŽµ'">`}updateHeaderNowPlaying(e){this.musicTitle&&(e&&e.trim().length>0?this.musicTitle.textContent=`Now Playing â€” ${e}`:this.musicTitle.textContent="Now Playing")}showEmbed(e){let t=document.getElementById("spotify-embed");t||(t=document.createElement("iframe"),t.id="spotify-embed",t.setAttribute("data-testid","embed-iframe"),t.style.borderRadius="12px",t.height="152",t.frameBorder="0",t.allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",t.loading="lazy",this.musicPlayerContent.prepend(t)),this.setEmbedResponsiveWidth(t),t.src=`https://open.spotify.com/embed/track/${e}?utm_source=generator`,this.toggleCustomPlayerVisibility(!1)}removeEmbedIfAny(){const e=document.getElementById("spotify-embed");e&&e.parentNode&&e.parentNode.removeChild(e),this.toggleCustomPlayerVisibility(!0)}toggleCustomPlayerVisibility(e){[document.querySelector(".track-info"),document.querySelector(".music-controls"),document.querySelector(".volume-control"),document.querySelector(".progress-container")].forEach(t=>{t&&(t.style.display=e?"":"none")})}togglePlayPause(){this.audio&&(this.isPlaying?(this.audio.pause(),this.isPlaying=!1,this.playPauseBtn.innerHTML='<i class="fas fa-play"></i>'):(this.audio.play(),this.isPlaying=!0,this.playPauseBtn.innerHTML='<i class="fas fa-pause"></i>'))}previousTrack(){this.audio&&(this.audio.currentTime=0)}nextTrack(){this.audio&&(this.audio.currentTime=0)}setVolume(e){this.audio&&(this.audio.volume=e/100);const t=document.querySelector(".volume-control i");t.className=0==e?"fas fa-volume-mute":e<50?"fas fa-volume-down":"fas fa-volume-up"}seekTo(e){if(!this.audio)return;const t=this.progressBar.getBoundingClientRect(),o=(e.clientX-t.left)/t.width*this.audio.duration;this.audio.currentTime=o}updateProgress(){if(!this.audio)return;const e=this.progressBar.querySelector(".progress"),t=this.audio.currentTime/this.audio.duration*100;e.style.width=`${t}%`,this.currentTimeSpan.textContent=this.formatTime(this.audio.currentTime)}formatTime(e){return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}}function initMusicPlayer(){musicPlayer=new SpotifyMusicPlayer}function initProjectFolders(){const e=document.querySelectorAll(".project-folder"),t={goldenbook:"https://goldenbookofficial.vercel.app/","triangle-completion":"https://github.com/sabpdo/Unity-Triangle_Completion","leftover-love":"https://leftover-love.vercel.app/welcome","eco-calc":"https://devpost.com/software/eco-calc",qoom:"https://kindswan26.qoom.space/edit/Unnamed/index.html",portfolio:"#",more:"https://github.com/sabpdo"};e.forEach(e=>{e.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation();const s=e.getAttribute("data-project"),n=t[s];n&&"#"!==n?(e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform="",window.open(n,"_blank")},150)):"portfolio"===s&&hideAllContentSections()}),e.addEventListener("keydown",t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.click())}),e.setAttribute("tabindex","0"),e.setAttribute("role","button"),e.setAttribute("aria-label",`Open ${e.querySelector(".folder-name").textContent} project`)})}function initBriefcaseAnimations(){document.querySelector(".briefcase-modal");const e=document.querySelectorAll(".experience-card"),t=document.querySelectorAll(".stat-badge"),o=document.querySelectorAll(".company-logo"),s=document.querySelectorAll(".tech-tag");document.querySelectorAll(".highlight-item");e.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{e.style.boxShadow="0 25px 50px rgba(102, 126, 234, 0.2), 0 0 0 1px rgba(102, 126, 234, 0.3)";const t=e.querySelector(".company-logo");t&&(t.style.transform="scale(1.15) rotate(10deg)",t.style.transition="transform 0.3s cubic-bezier(0.4, 0, 0.2, 1)");e.querySelectorAll(".tech-tag").forEach((e,t)=>{setTimeout(()=>{e.style.transform="translateY(-3px) scale(1.05)",e.style.transition="transform 0.2s ease"},50*t)});e.querySelectorAll(".highlight-item").forEach((e,t)=>{setTimeout(()=>{e.style.transform="translateY(-2px) scale(1.02)",e.style.transition="transform 0.2s ease"},100*t)})}),e.addEventListener("mouseleave",()=>{e.style.boxShadow="";const t=e.querySelector(".company-logo");t&&(t.style.transform="");e.querySelectorAll(".tech-tag").forEach(e=>{e.style.transform=""});e.querySelectorAll(".highlight-item").forEach(e=>{e.style.transform=""})})}),t.forEach(e=>{e.addEventListener("click",()=>{e.style.transform="scale(0.95)",setTimeout(()=>{e.style.transform=""},150)})}),o.forEach(e=>{e.addEventListener("click",t=>{const o=document.createElement("div"),s=e.getBoundingClientRect(),n=Math.max(s.width,s.height),i=t.clientX-s.left-n/2,a=t.clientY-s.top-n/2;o.style.cssText=`\n        position: absolute;\n        width: ${n}px;\n        height: ${n}px;\n        left: ${i}px;\n        top: ${a}px;\n        background: rgba(255, 255, 255, 0.3);\n        border-radius: 50%;\n        transform: scale(0);\n        animation: ripple 0.6s ease-out;\n        pointer-events: none;\n      `,e.style.position="relative",e.style.overflow="hidden",e.appendChild(o),setTimeout(()=>{o.remove()},600)})});const n=document.createElement("style");n.textContent="\n    @keyframes ripple {\n      to {\n        transform: scale(2);\n        opacity: 0;\n      }\n    }\n  ",document.head.appendChild(n),s.forEach((e,t)=>{e.addEventListener("mouseenter",()=>{e.style.transform="translateY(-4px) scale(1.1)",e.style.boxShadow="0 8px 20px rgba(102, 126, 234, 0.3)"}),e.addEventListener("mouseleave",()=>{e.style.transform="",e.style.boxShadow=""})});document.querySelectorAll(".achievement-description p").forEach((e,t)=>{const o=e.textContent;e.textContent="",e.style.borderRight="2px solid #667eea",e.style.animation="blink 1s infinite",setTimeout(()=>{let t=0;const s=()=>{t<o.length?(e.textContent+=o.charAt(t),t++,setTimeout(s,20)):(e.style.borderRight="none",e.style.animation="none")};s()},2e3+1e3*t)});const i=document.createElement("style");i.textContent="\n    @keyframes blink {\n      0%, 50% { border-color: #667eea; }\n      51%, 100% { border-color: transparent; }\n    }\n  ",document.head.appendChild(i)}function toggleSection(e){const t=document.getElementById(e+"-content"),o=document.querySelector(`[onclick="toggleSection('${e}')"]`),s=o.querySelector("i");t.classList.contains("collapsed")?(t.classList.remove("collapsed"),o.classList.remove("collapsed"),setTimeout(()=>{s.style.transform="rotate(0deg)"},50)):(t.classList.add("collapsed"),o.classList.add("collapsed"),s.style.transform="rotate(-90deg)")}function closeBriefcaseModal(){const e=document.getElementById("experience");e&&(e.classList.remove("active"),e.style.display="none",showMusicPlayer(),enableBodyScroll())}window.onSpotifyWebPlaybackSDKReady=window.onSpotifyWebPlaybackSDKReady||function(){},document.addEventListener("DOMContentLoaded",()=>{initBriefcaseAnimations()}),window.addEventListener("beforeunload",()=>{animationId&&cancelAnimationFrame(animationId)});